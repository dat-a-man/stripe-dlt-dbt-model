

============================== 02:44:32.163830 | fe07c06c-ecdd-4680-ab7f-787d7d090a55 ==============================
[0m02:44:32.163830 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:44:32.166273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/stripe-dlt-dbbt-model/dbt_stripe_analytics_tst2/logs', 'profiles_dir': '/home/codespace/.python/current/lib/python3.12/site-packages/dlt/helpers/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'True', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m02:44:32.166816 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:44:32.329700 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:44:32.330709 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:44:32.331761 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.23275681, "process_user_time": 2.110559, "process_kernel_time": 0.270788, "process_mem_max_rss": "206236", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m02:44:32.332480 [debug] [MainThread]: Command `cli deps` succeeded at 02:44:32.332349 after 0.23 seconds
[0m02:44:32.333009 [debug] [MainThread]: Flushing usage events


============================== 02:44:35.010488 | 20762b66-dd81-4f97-a43b-72da4fe82c44 ==============================
[0m02:44:35.010488 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:44:35.012785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.python/current/lib/python3.12/site-packages/dlt/helpers/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/stripe-dlt-dbbt-model/dbt_stripe_analytics_tst2/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m02:44:35.013347 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:44:35.641332 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m02:44:35.654320 [debug] [MainThread]: checksum: 4979aa4c9bb5bcfb384c4a4530246e9bb980b856d25b8329bb0b09ffc5919160, vars: {'destination_dataset_name': 'stripe_tst_2_transformed',
 'source_dataset_name': 'stripe_tst_2'}, profile: bigquery, target: , version: 1.8.7
[0m02:44:35.655663 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:44:36.938767 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:44:36.943725 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name '_dlt_loads' in the 'models' section of file 'models/sources.yml'
[0m02:44:36.961256 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'subscription' in the 'models' section of file 'models/sources.yml'
[0m02:44:36.963958 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'coupon' in the 'models' section of file 'models/sources.yml'
[0m02:44:36.967425 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customer' in the 'models' section of file 'models/sources.yml'
[0m02:44:36.970091 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'product' in the 'models' section of file 'models/sources.yml'
[0m02:44:36.973905 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'price' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.023060 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.037277 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'invoice' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.041174 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'balance_transaction' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.043249 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'balance_transaction__fee_details' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.044840 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event__data__object__discounts' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.054158 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event__data__object__lines__data' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.055906 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event__data__object__lines__data__discount_amounts' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.057251 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event__data__object__total_discount_amounts' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.058935 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event__data__object__available' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.060276 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event__data__object__pending' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.061556 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event__data__object__payment_method_types' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.063742 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'event__data__object__items__data' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.065033 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'invoice__discounts' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.067428 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'invoice__lines__data' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.068746 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'invoice__lines__data__discount_amounts' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.070043 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'invoice__total_discount_amounts' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.071452 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'subscription__discounts' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.073519 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'subscription__items__data' in the 'models' section of file 'models/sources.yml'
[0m02:44:37.531001 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null__dlt_loads_load_id.aced3f4300' (models/sources.yml) depends on a node named '_dlt_loads' in package '' which was not found
[0m02:44:37.531656 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null__dlt_loads_status.231190b63d' (models/sources.yml) depends on a node named '_dlt_loads' in package '' which was not found
[0m02:44:37.532183 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null__dlt_loads_inserted_at.94eab1945d' (models/sources.yml) depends on a node named '_dlt_loads' in package '' which was not found
[0m02:44:37.532693 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription_id.be9551387f' (models/sources.yml) depends on a node named 'subscription' in package '' which was not found
[0m02:44:37.533195 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription__dlt_load_id.98735ce09c' (models/sources.yml) depends on a node named 'subscription' in package '' which was not found
[0m02:44:37.533698 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription__dlt_id.cfc98ca39d' (models/sources.yml) depends on a node named 'subscription' in package '' which was not found
[0m02:44:37.534214 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_subscription__dlt_id.4bb8bb84de' (models/sources.yml) depends on a node named 'subscription' in package '' which was not found
[0m02:44:37.534737 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_coupon__dlt_load_id.0936cd0486' (models/sources.yml) depends on a node named 'coupon' in package '' which was not found
[0m02:44:37.535247 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_coupon__dlt_id.4def0c0ab9' (models/sources.yml) depends on a node named 'coupon' in package '' which was not found
[0m02:44:37.535756 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_coupon__dlt_id.8597db118a' (models/sources.yml) depends on a node named 'coupon' in package '' which was not found
[0m02:44:37.536251 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_customer__dlt_load_id.ea475ae147' (models/sources.yml) depends on a node named 'customer' in package '' which was not found
[0m02:44:37.536752 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_customer__dlt_id.510b2c016d' (models/sources.yml) depends on a node named 'customer' in package '' which was not found
[0m02:44:37.537244 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_customer__dlt_id.ae209f1dbd' (models/sources.yml) depends on a node named 'customer' in package '' which was not found
[0m02:44:37.537732 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_product__dlt_load_id.7840224356' (models/sources.yml) depends on a node named 'product' in package '' which was not found
[0m02:44:37.538243 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_product__dlt_id.8832ce1ce9' (models/sources.yml) depends on a node named 'product' in package '' which was not found
[0m02:44:37.538736 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_product__dlt_id.562ac2a94d' (models/sources.yml) depends on a node named 'product' in package '' which was not found
[0m02:44:37.539223 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_price__dlt_load_id.7af7cdb0d4' (models/sources.yml) depends on a node named 'price' in package '' which was not found
[0m02:44:37.539707 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_price__dlt_id.2f1aad4641' (models/sources.yml) depends on a node named 'price' in package '' which was not found
[0m02:44:37.540201 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_price__dlt_id.8fb5ef5005' (models/sources.yml) depends on a node named 'price' in package '' which was not found
[0m02:44:37.540682 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event_id.66294ddd3c' (models/sources.yml) depends on a node named 'event' in package '' which was not found
[0m02:44:37.541165 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__dlt_load_id.0863e3bbfe' (models/sources.yml) depends on a node named 'event' in package '' which was not found
[0m02:44:37.541646 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__dlt_id.2ffa5f72cf' (models/sources.yml) depends on a node named 'event' in package '' which was not found
[0m02:44:37.542155 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__dlt_id.f44f616da4' (models/sources.yml) depends on a node named 'event' in package '' which was not found
[0m02:44:37.542649 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice_id.231b78a2eb' (models/sources.yml) depends on a node named 'invoice' in package '' which was not found
[0m02:44:37.543134 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__dlt_load_id.d3e54327a7' (models/sources.yml) depends on a node named 'invoice' in package '' which was not found
[0m02:44:37.543634 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__dlt_id.204e00c245' (models/sources.yml) depends on a node named 'invoice' in package '' which was not found
[0m02:44:37.544140 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_invoice__dlt_id.ddb7606881' (models/sources.yml) depends on a node named 'invoice' in package '' which was not found
[0m02:44:37.544637 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_balance_transaction_id.0f2e031070' (models/sources.yml) depends on a node named 'balance_transaction' in package '' which was not found
[0m02:44:37.545134 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_balance_transaction__dlt_load_id.de9646bb42' (models/sources.yml) depends on a node named 'balance_transaction' in package '' which was not found
[0m02:44:37.545635 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_balance_transaction__dlt_id.ce34a38233' (models/sources.yml) depends on a node named 'balance_transaction' in package '' which was not found
[0m02:44:37.546159 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_balance_transaction__dlt_id.3977e460cf' (models/sources.yml) depends on a node named 'balance_transaction' in package '' which was not found
[0m02:44:37.546661 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_balance_transaction__fee_details__dlt_parent_id.f7609cd4fc' (models/sources.yml) depends on a node named 'balance_transaction__fee_details' in package '' which was not found
[0m02:44:37.547165 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_balance_transaction__fee_details__dlt_list_idx.184c206e8e' (models/sources.yml) depends on a node named 'balance_transaction__fee_details' in package '' which was not found
[0m02:44:37.547674 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_balance_transaction__fee_details__dlt_id.bc737429e7' (models/sources.yml) depends on a node named 'balance_transaction__fee_details' in package '' which was not found
[0m02:44:37.548175 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_balance_transaction__fee_details__dlt_id.ee4a82bf98' (models/sources.yml) depends on a node named 'balance_transaction__fee_details' in package '' which was not found
[0m02:44:37.548671 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__discounts__dlt_id.90bade6a57' (models/sources.yml) depends on a node named 'event__data__object__discounts' in package '' which was not found
[0m02:44:37.549173 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__data__object__discounts__dlt_id.077ba3f36d' (models/sources.yml) depends on a node named 'event__data__object__discounts' in package '' which was not found
[0m02:44:37.549665 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__discounts__dlt_parent_id.8c95c9abe6' (models/sources.yml) depends on a node named 'event__data__object__discounts' in package '' which was not found
[0m02:44:37.550184 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__discounts__dlt_list_idx.9f650e1ad8' (models/sources.yml) depends on a node named 'event__data__object__discounts' in package '' which was not found
[0m02:44:37.550684 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__lines__data__dlt_parent_id.5ead7281dd' (models/sources.yml) depends on a node named 'event__data__object__lines__data' in package '' which was not found
[0m02:44:37.551195 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__lines__data__dlt_list_idx.638ec5a0c5' (models/sources.yml) depends on a node named 'event__data__object__lines__data' in package '' which was not found
[0m02:44:37.551700 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__lines__data__dlt_id.5edb01cba7' (models/sources.yml) depends on a node named 'event__data__object__lines__data' in package '' which was not found
[0m02:44:37.552186 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__data__object__lines__data__dlt_id.0bdcd21803' (models/sources.yml) depends on a node named 'event__data__object__lines__data' in package '' which was not found
[0m02:44:37.552694 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__lines__data__discount_amounts__dlt_parent_id.a815071024' (models/sources.yml) depends on a node named 'event__data__object__lines__data__discount_amounts' in package '' which was not found
[0m02:44:37.553198 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__lines__data__discount_amounts__dlt_list_idx.809f0f0b20' (models/sources.yml) depends on a node named 'event__data__object__lines__data__discount_amounts' in package '' which was not found
[0m02:44:37.553689 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__lines__data__discount_amounts__dlt_id.af93e970e2' (models/sources.yml) depends on a node named 'event__data__object__lines__data__discount_amounts' in package '' which was not found
[0m02:44:37.554212 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__data__object__lines__data__discount_amounts__dlt_id.a3888ab571' (models/sources.yml) depends on a node named 'event__data__object__lines__data__discount_amounts' in package '' which was not found
[0m02:44:37.554719 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__total_discount_amounts__dlt_parent_id.5726be4e25' (models/sources.yml) depends on a node named 'event__data__object__total_discount_amounts' in package '' which was not found
[0m02:44:37.555230 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__total_discount_amounts__dlt_list_idx.0e60b23ddd' (models/sources.yml) depends on a node named 'event__data__object__total_discount_amounts' in package '' which was not found
[0m02:44:37.555729 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__total_discount_amounts__dlt_id.e16ee54ec2' (models/sources.yml) depends on a node named 'event__data__object__total_discount_amounts' in package '' which was not found
[0m02:44:37.556226 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__data__object__total_discount_amounts__dlt_id.3540b56d8c' (models/sources.yml) depends on a node named 'event__data__object__total_discount_amounts' in package '' which was not found
[0m02:44:37.556754 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__available__dlt_parent_id.1e36a0cd2f' (models/sources.yml) depends on a node named 'event__data__object__available' in package '' which was not found
[0m02:44:37.557248 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__available__dlt_list_idx.0f07f28966' (models/sources.yml) depends on a node named 'event__data__object__available' in package '' which was not found
[0m02:44:37.557802 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__available__dlt_id.0534127014' (models/sources.yml) depends on a node named 'event__data__object__available' in package '' which was not found
[0m02:44:37.558329 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__data__object__available__dlt_id.0b76a26661' (models/sources.yml) depends on a node named 'event__data__object__available' in package '' which was not found
[0m02:44:37.558821 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__pending__dlt_parent_id.e7927423de' (models/sources.yml) depends on a node named 'event__data__object__pending' in package '' which was not found
[0m02:44:37.559327 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__pending__dlt_list_idx.2ef5eaa68e' (models/sources.yml) depends on a node named 'event__data__object__pending' in package '' which was not found
[0m02:44:37.559827 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__pending__dlt_id.8ce60494aa' (models/sources.yml) depends on a node named 'event__data__object__pending' in package '' which was not found
[0m02:44:37.560324 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__data__object__pending__dlt_id.e8815309bb' (models/sources.yml) depends on a node named 'event__data__object__pending' in package '' which was not found
[0m02:44:37.560818 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__payment_method_types__dlt_id.4d7da5be8e' (models/sources.yml) depends on a node named 'event__data__object__payment_method_types' in package '' which was not found
[0m02:44:37.561309 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__data__object__payment_method_types__dlt_id.adde628069' (models/sources.yml) depends on a node named 'event__data__object__payment_method_types' in package '' which was not found
[0m02:44:37.561801 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__payment_method_types__dlt_parent_id.96acafde17' (models/sources.yml) depends on a node named 'event__data__object__payment_method_types' in package '' which was not found
[0m02:44:37.562326 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__payment_method_types__dlt_list_idx.cc4fd1de20' (models/sources.yml) depends on a node named 'event__data__object__payment_method_types' in package '' which was not found
[0m02:44:37.562819 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__items__data__dlt_parent_id.1ad8dc248b' (models/sources.yml) depends on a node named 'event__data__object__items__data' in package '' which was not found
[0m02:44:37.563319 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__items__data__dlt_list_idx.975d75b28c' (models/sources.yml) depends on a node named 'event__data__object__items__data' in package '' which was not found
[0m02:44:37.563815 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_event__data__object__items__data__dlt_id.96a91ba1dd' (models/sources.yml) depends on a node named 'event__data__object__items__data' in package '' which was not found
[0m02:44:37.564304 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_event__data__object__items__data__dlt_id.65eb5cf953' (models/sources.yml) depends on a node named 'event__data__object__items__data' in package '' which was not found
[0m02:44:37.564800 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__discounts__dlt_id.ef25374a83' (models/sources.yml) depends on a node named 'invoice__discounts' in package '' which was not found
[0m02:44:37.565302 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_invoice__discounts__dlt_id.046e2b7b49' (models/sources.yml) depends on a node named 'invoice__discounts' in package '' which was not found
[0m02:44:37.565809 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__discounts__dlt_parent_id.50739e42f4' (models/sources.yml) depends on a node named 'invoice__discounts' in package '' which was not found
[0m02:44:37.566320 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__discounts__dlt_list_idx.e16b785764' (models/sources.yml) depends on a node named 'invoice__discounts' in package '' which was not found
[0m02:44:37.566814 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__lines__data__dlt_parent_id.0d5c395428' (models/sources.yml) depends on a node named 'invoice__lines__data' in package '' which was not found
[0m02:44:37.567309 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__lines__data__dlt_list_idx.2611e4482f' (models/sources.yml) depends on a node named 'invoice__lines__data' in package '' which was not found
[0m02:44:37.567794 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__lines__data__dlt_id.66671cafd7' (models/sources.yml) depends on a node named 'invoice__lines__data' in package '' which was not found
[0m02:44:37.568279 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_invoice__lines__data__dlt_id.5ee5b9c577' (models/sources.yml) depends on a node named 'invoice__lines__data' in package '' which was not found
[0m02:44:37.568768 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__lines__data__discount_amounts__dlt_parent_id.e6d52306e5' (models/sources.yml) depends on a node named 'invoice__lines__data__discount_amounts' in package '' which was not found
[0m02:44:37.569265 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__lines__data__discount_amounts__dlt_list_idx.02ea1ffc27' (models/sources.yml) depends on a node named 'invoice__lines__data__discount_amounts' in package '' which was not found
[0m02:44:37.569764 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__lines__data__discount_amounts__dlt_id.b8a620d200' (models/sources.yml) depends on a node named 'invoice__lines__data__discount_amounts' in package '' which was not found
[0m02:44:37.570287 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_invoice__lines__data__discount_amounts__dlt_id.ee703d59ee' (models/sources.yml) depends on a node named 'invoice__lines__data__discount_amounts' in package '' which was not found
[0m02:44:37.570784 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__total_discount_amounts__dlt_parent_id.35d2e506e8' (models/sources.yml) depends on a node named 'invoice__total_discount_amounts' in package '' which was not found
[0m02:44:37.571294 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__total_discount_amounts__dlt_list_idx.ffbf13a375' (models/sources.yml) depends on a node named 'invoice__total_discount_amounts' in package '' which was not found
[0m02:44:37.571788 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_invoice__total_discount_amounts__dlt_id.f02149d6ae' (models/sources.yml) depends on a node named 'invoice__total_discount_amounts' in package '' which was not found
[0m02:44:37.572277 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_invoice__total_discount_amounts__dlt_id.6a47b7e379' (models/sources.yml) depends on a node named 'invoice__total_discount_amounts' in package '' which was not found
[0m02:44:37.572771 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription__discounts__dlt_id.f3c9da27ef' (models/sources.yml) depends on a node named 'subscription__discounts' in package '' which was not found
[0m02:44:37.573260 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_subscription__discounts__dlt_id.544ea163e0' (models/sources.yml) depends on a node named 'subscription__discounts' in package '' which was not found
[0m02:44:37.573750 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription__discounts__dlt_parent_id.862fd465e0' (models/sources.yml) depends on a node named 'subscription__discounts' in package '' which was not found
[0m02:44:37.574261 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription__discounts__dlt_list_idx.f8e86dd296' (models/sources.yml) depends on a node named 'subscription__discounts' in package '' which was not found
[0m02:44:37.574757 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription__items__data__dlt_parent_id.e1be741178' (models/sources.yml) depends on a node named 'subscription__items__data' in package '' which was not found
[0m02:44:37.575253 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription__items__data__dlt_list_idx.3c817b5b88' (models/sources.yml) depends on a node named 'subscription__items__data' in package '' which was not found
[0m02:44:37.575746 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.not_null_subscription__items__data__dlt_id.e57719358a' (models/sources.yml) depends on a node named 'subscription__items__data' in package '' which was not found
[0m02:44:37.576241 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stripe_analytics_tst2.unique_subscription__items__data__dlt_id.2b207a2020' (models/sources.yml) depends on a node named 'subscription__items__data' in package '' which was not found
[0m02:44:37.898577 [info ] [MainThread]: Found 50 models, 25 sources, 479 macros
[0m02:44:37.901523 [info ] [MainThread]: 
[0m02:44:37.902009 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:44:37.902724 [debug] [MainThread]: Command end result
[0m02:44:37.952085 [info ] [MainThread]: 
[0m02:44:37.952644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:37.953104 [info ] [MainThread]: 
[0m02:44:37.953601 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m02:44:37.954612 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.0087852, "process_user_time": 5.055058, "process_kernel_time": 0.305525, "process_mem_max_rss": "245204", "process_out_blocks": "5504", "process_in_blocks": "0"}
[0m02:44:37.955291 [debug] [MainThread]: Command `cli seed` succeeded at 02:44:37.955180 after 3.01 seconds
[0m02:44:37.955795 [debug] [MainThread]: Flushing usage events


============================== 02:44:40.658699 | 0aebcfa5-fbdf-45cc-8f88-f357c0b6204b ==============================
[0m02:44:40.658699 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:44:40.661108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/workspaces/stripe-dlt-dbbt-model/dbt_stripe_analytics_tst2/logs', 'debug': 'False', 'profiles_dir': '/home/codespace/.python/current/lib/python3.12/site-packages/dlt/helpers/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m02:44:40.661684 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:44:41.261946 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m02:44:41.275292 [debug] [MainThread]: checksum: 4979aa4c9bb5bcfb384c4a4530246e9bb980b856d25b8329bb0b09ffc5919160, vars: {'destination_dataset_name': 'stripe_tst_2_transformed',
 'source_dataset_name': 'stripe_tst_2'}, profile: bigquery, target: , version: 1.8.7
[0m02:44:41.421822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:44:41.422489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:44:41.606373 [info ] [MainThread]: Found 50 models, 25 sources, 479 macros
[0m02:44:41.612450 [info ] [MainThread]: 
[0m02:44:41.613464 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:44:41.623371 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dlt-dev-external'
[0m02:44:41.624212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:42.497907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dlt-dev-external, now list_dlt-dev-external_stripe_tst_2_transformed)
[0m02:44:42.498639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:43.158885 [info ] [MainThread]: Concurrency: 4 threads (target='analytics')
[0m02:44:43.159413 [info ] [MainThread]: 
[0m02:44:43.161592 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.dlt_active_load_ids
[0m02:44:43.162301 [info ] [Thread-1 (]: 1 of 50 START sql table model stripe_tst_2_transformed.dlt_active_load_ids ..... [RUN]
[0m02:44:43.162875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dlt-dev-external_stripe_tst_2_transformed, now model.stripe_analytics_tst2.dlt_active_load_ids)
[0m02:44:43.163420 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.dlt_active_load_ids
[0m02:44:43.174242 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dlt_active_load_ids"
[0m02:44:43.175178 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.dlt_active_load_ids
[0m02:44:43.213919 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dlt_active_load_ids"
[0m02:44:43.214888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:43.216318 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.dlt_active_load_ids: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dlt_active_load_ids"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
      
    
    

    OPTIONS()
    as (
      /* check if the destination already has a list of processed ids
if not we will process all loads with status 0 (==success) */


SELECT load_id FROM `dlt-dev-external`.`stripe_tst_2`.`_dlt_loads`
WHERE status = 0
/* exclude already processed load_ids */

    );
  
[0m02:44:44.069914 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:2f6dbd7b-b727-48ee-be4e-760815e917de&page=queryresults
[0m02:44:46.298668 [info ] [Thread-1 (]: 1 of 50 OK created sql table model stripe_tst_2_transformed.dlt_active_load_ids  [[32mCREATE TABLE (1.0 rows, 28.0 Bytes processed)[0m in 3.13s]
[0m02:44:46.299600 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.dlt_active_load_ids
[0m02:44:46.300805 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.stg__dlt_loads
[0m02:44:46.301433 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.stg_balance_transaction
[0m02:44:46.301968 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.stg_coupon
[0m02:44:46.302582 [info ] [Thread-3 (]: 2 of 50 START sql table model stripe_tst_2_transformed.stg__dlt_loads .......... [RUN]
[0m02:44:46.303074 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.stg_customer
[0m02:44:46.303714 [info ] [Thread-4 (]: 3 of 50 START sql table model stripe_tst_2_transformed.stg_balance_transaction . [RUN]
[0m02:44:46.304364 [info ] [Thread-2 (]: 4 of 50 START sql table model stripe_tst_2_transformed.stg_coupon .............. [RUN]
[0m02:44:46.305039 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.stripe_analytics_tst2.stg__dlt_loads'
[0m02:44:46.305693 [info ] [Thread-1 (]: 5 of 50 START sql table model stripe_tst_2_transformed.stg_customer ............ [RUN]
[0m02:44:46.306379 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.stripe_analytics_tst2.stg_balance_transaction'
[0m02:44:46.307031 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.stripe_analytics_tst2.stg_coupon'
[0m02:44:46.307607 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.stg__dlt_loads
[0m02:44:46.308195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dlt_active_load_ids, now model.stripe_analytics_tst2.stg_customer)
[0m02:44:46.308791 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.stg_balance_transaction
[0m02:44:46.309354 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.stg_coupon
[0m02:44:46.312732 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg__dlt_loads"
[0m02:44:46.313335 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.stg_customer
[0m02:44:46.316737 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_balance_transaction"
[0m02:44:46.320080 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_coupon"
[0m02:44:46.325330 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_customer"
[0m02:44:46.326245 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.stg_balance_transaction
[0m02:44:46.326742 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.stg_coupon
[0m02:44:46.327350 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.stg__dlt_loads
[0m02:44:46.328030 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.stg_customer
[0m02:44:46.330620 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_balance_transaction"
[0m02:44:46.333174 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_coupon"
[0m02:44:46.335766 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg__dlt_loads"
[0m02:44:46.338510 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_customer"
[0m02:44:46.339444 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:44:46.344433 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.stg_coupon: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_coupon"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_coupon`
      
    
    

    OPTIONS()
    as (
      /* Table: coupon */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table 'coupon' */
    id,
    object,
    created,
    duration,
    livemode,
    percent_off,
    times_redeemed,
    valid,
    _dlt_load_id,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`coupon`

/* we only load table items of the currently active load ids into the staging table */
WHERE _dlt_load_id IN ( SELECT load_id FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids` )
    );
  
[0m02:44:46.340090 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:44:46.341855 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:44:46.373438 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.stg_balance_transaction: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_balance_transaction"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_balance_transaction`
      
    
    

    OPTIONS()
    as (
      /* Table: balance_transaction */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table 'balance_transaction' */
    id,
    object,
    amount,
    available_on,
    created,
    currency,
    description,
    fee,
    net,
    reporting_category,
    status,
    type,
    _dlt_load_id,
    _dlt_id,
    exchange_rate,
    source,
FROM `dlt-dev-external`.`stripe_tst_2`.`balance_transaction`

/* we only load table items of the currently active load ids into the staging table */
WHERE _dlt_load_id IN ( SELECT load_id FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids` )
    );
  
[0m02:44:46.374264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:46.376927 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.stg__dlt_loads: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg__dlt_loads"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg__dlt_loads`
      
    
    

    OPTIONS()
    as (
      /* Table: _dlt_loads */
/* Description: Created by DLT. Tracks completed loads */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table '_dlt_loads' */
    load_id,
    schema_name,
    status,
    inserted_at,
    schema_version_hash,
FROM `dlt-dev-external`.`stripe_tst_2`.`_dlt_loads`
    );
  
[0m02:44:46.379287 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_customer"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_customer`
      
    
    

    OPTIONS()
    as (
      /* Table: customer */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table 'customer' */
    id,
    object,
    balance,
    created,
    currency,
    delinquent,
    email,
    invoice_prefix,
    invoice_settings__default_payment_method,
    livemode,
    name,
    tax_exempt,
    _dlt_load_id,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`customer`

/* we only load table items of the currently active load ids into the staging table */
WHERE _dlt_load_id IN ( SELECT load_id FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids` )
    );
  
[0m02:44:47.185179 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:329f9d8e-6009-4e3a-a989-62e8f583dc1f&page=queryresults
[0m02:44:47.187927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:f711df6f-728f-4232-ad51-00a6f276324f&page=queryresults
[0m02:44:47.213102 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:73027914-26d5-47bb-80c3-a85a70c83fae&page=queryresults
[0m02:44:47.324009 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:a29477f5-749c-4af1-98e4-5961c0a21c7e&page=queryresults
[0m02:44:49.519350 [info ] [Thread-2 (]: 4 of 50 OK created sql table model stripe_tst_2_transformed.stg_coupon ......... [[32mCREATE TABLE (4.0 rows, 404.0 Bytes processed)[0m in 3.21s]
[0m02:44:49.520264 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.stg_coupon
[0m02:44:49.520891 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.stg_event
[0m02:44:49.521672 [info ] [Thread-2 (]: 6 of 50 START sql table model stripe_tst_2_transformed.stg_event ............... [RUN]
[0m02:44:49.522351 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_coupon, now model.stripe_analytics_tst2.stg_event)
[0m02:44:49.522903 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.stg_event
[0m02:44:49.527220 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event"
[0m02:44:49.527966 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.stg_event
[0m02:44:49.530650 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event"
[0m02:44:49.531365 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:49.533017 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.stg_event: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event`
      
    
    

    OPTIONS()
    as (
      /* Table: event */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table 'event' */
    id,
    object,
    api_version,
    created,
    data__object__object,
    data__object__account_country,
    data__object__amount_due,
    data__object__amount_paid,
    data__object__amount_remaining,
    data__object__amount_shipping,
    data__object__attempt_count,
    data__object__attempted,
    data__object__automatic_tax__enabled,
    data__object__billing_reason,
    data__object__collection_method,
    data__object__created,
    data__object__currency,
    data__object__customer,
    data__object__customer_email,
    data__object__customer_name,
    data__object__customer_tax_exempt,
    data__object__discount__id,
    data__object__discount__object,
    data__object__discount__coupon__id,
    data__object__discount__coupon__object,
    data__object__discount__coupon__created,
    data__object__discount__coupon__duration,
    data__object__discount__coupon__livemode,
    data__object__discount__coupon__percent_off,
    data__object__discount__coupon__times_redeemed,
    data__object__discount__coupon__valid,
    data__object__discount__customer,
    data__object__discount__start,
    data__object__discount__subscription,
    data__object__ending_balance,
    data__object__issuer__type,
    data__object__lines__object,
    data__object__lines__has_more,
    data__object__lines__total_count,
    data__object__lines__url,
    data__object__livemode,
    data__object__next_payment_attempt,
    data__object__paid,
    data__object__paid_out_of_band,
    data__object__period_end,
    data__object__period_start,
    data__object__post_payment_credit_notes_amount,
    data__object__pre_payment_credit_notes_amount,
    data__object__starting_balance,
    data__object__status,
    data__object__subscription,
    data__object__subtotal,
    data__object__subtotal_excluding_tax,
    data__object__total,
    data__object__total_excluding_tax,
    livemode,
    pending_webhooks,
    type,
    _dlt_load_id,
    _dlt_id,
    data__object__id,
    data__object__auto_advance,
    data__object__charge,
    data__object__effective_at,
    data__object__hosted_invoice_url,
    data__object__invoice_pdf,
    data__object__number,
    data__object__payment_intent,
    data__object__status_transitions__finalized_at,
    data__object__status_transitions__paid_at,
    data__object__webhooks_delivered_at,
    data__previous_attributes__amount_paid,
    data__previous_attributes__amount_remaining,
    data__previous_attributes__attempt_count,
    data__previous_attributes__attempted,
    data__previous_attributes__auto_advance,
    data__previous_attributes__automatically_finalizes_at,
    data__previous_attributes__next_payment_attempt,
    data__previous_attributes__paid,
    data__previous_attributes__status,
    data__object__amount,
    data__object__amount_capturable,
    data__object__amount_received,
    data__object__capture_method,
    data__object__client_secret,
    data__object__confirmation_method,
    data__object__description,
    data__object__invoice,
    data__object__payment_method_options__card__request_three_d_secure,
    data__object__latest_charge,
    data__object__payment_method,
    request__idempotency_key,
    data__object__amount_captured,
    data__object__amount_refunded,
    data__object__balance_transaction,
    data__object__calculated_statement_descriptor,
    data__object__captured,
    data__object__disputed,
    data__object__outcome__network_status,
    data__object__outcome__risk_level,
    data__object__outcome__risk_score,
    data__object__outcome__seller_message,
    data__object__outcome__type,
    data__object__payment_method_details__card__amount_authorized,
    data__object__payment_method_details__card__brand,
    data__object__payment_method_details__card__country,
    data__object__payment_method_details__card__exp_month,
    data__object__payment_method_details__card__exp_year,
    data__object__payment_method_details__card__extended_authorization__status,
    data__object__payment_method_details__card__fingerprint,
    data__object__payment_method_details__card__funding,
    data__object__payment_method_details__card__incremental_authorization__status,
    data__object__payment_method_details__card__last4,
    data__object__payment_method_details__card__multicapture__status,
    data__object__payment_method_details__card__network,
    data__object__payment_method_details__card__network_token__used,
    data__object__payment_method_details__card__overcapture__maximum_amount_capturable,
    data__object__payment_method_details__card__overcapture__status,
    data__object__payment_method_details__type,
    data__object__receipt_url,
    data__object__refunded,
    data__object__billing_cycle_anchor,
    data__object__cancel_at_period_end,
    data__object__current_period_end,
    data__object__current_period_start,
    data__object__invoice_settings__issuer__type,
    data__object__items__object,
    data__object__items__has_more,
    data__object__items__total_count,
    data__object__items__url,
    data__object__latest_invoice,
    data__object__payment_settings__save_default_payment_method,
    data__object__plan__id,
    data__object__plan__object,
    data__object__plan__active,
    data__object__plan__amount,
    data__object__plan__amount_decimal,
    data__object__plan__billing_scheme,
    data__object__plan__created,
    data__object__plan__currency,
    data__object__plan__interval,
    data__object__plan__interval_count,
    data__object__plan__livemode,
    data__object__plan__product,
    data__object__plan__usage_type,
    data__object__quantity,
    data__object__start_date,
    data__object__trial_settings__end_behavior__missing_payment_method,
    data__previous_attributes__current_period_end,
    data__previous_attributes__current_period_start,
    data__previous_attributes__latest_invoice,
    data__object__automatically_finalizes_at,
FROM `dlt-dev-external`.`stripe_tst_2`.`event`

/* we only load table items of the currently active load ids into the staging table */
WHERE _dlt_load_id IN ( SELECT load_id FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids` )
    );
  
[0m02:44:49.649850 [info ] [Thread-1 (]: 5 of 50 OK created sql table model stripe_tst_2_transformed.stg_customer ....... [[32mCREATE TABLE (300.0 rows, 51.6 KiB processed)[0m in 3.34s]
[0m02:44:49.650684 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.stg_customer
[0m02:44:49.651302 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.stg_invoice
[0m02:44:49.652084 [info ] [Thread-1 (]: 7 of 50 START sql table model stripe_tst_2_transformed.stg_invoice ............. [RUN]
[0m02:44:49.652682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_customer, now model.stripe_analytics_tst2.stg_invoice)
[0m02:44:49.653223 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.stg_invoice
[0m02:44:49.656892 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_invoice"
[0m02:44:49.659323 [info ] [Thread-3 (]: 2 of 50 OK created sql table model stripe_tst_2_transformed.stg__dlt_loads ..... [[32mCREATE TABLE (1.0 rows, 97.0 Bytes processed)[0m in 3.35s]
[0m02:44:49.660145 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.stg__dlt_loads
[0m02:44:49.660634 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.stg_invoice
[0m02:44:49.661257 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.stg_price
[0m02:44:49.664040 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_invoice"
[0m02:44:49.664732 [info ] [Thread-3 (]: 8 of 50 START sql table model stripe_tst_2_transformed.stg_price ............... [RUN]
[0m02:44:49.665554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg__dlt_loads, now model.stripe_analytics_tst2.stg_price)
[0m02:44:49.666102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:49.666667 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.stg_price
[0m02:44:49.668149 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.stg_invoice: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_invoice"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table 'invoice' */
    id,
    object,
    account_country,
    amount_due,
    amount_paid,
    amount_remaining,
    amount_shipping,
    attempt_count,
    attempted,
    auto_advance,
    automatic_tax__enabled,
    billing_reason,
    charge,
    collection_method,
    created,
    currency,
    customer,
    customer_email,
    customer_name,
    customer_tax_exempt,
    discount__id,
    discount__object,
    discount__coupon__id,
    discount__coupon__object,
    discount__coupon__created,
    discount__coupon__duration,
    discount__coupon__livemode,
    discount__coupon__percent_off,
    discount__coupon__times_redeemed,
    discount__coupon__valid,
    discount__customer,
    discount__start,
    discount__subscription,
    effective_at,
    ending_balance,
    hosted_invoice_url,
    invoice_pdf,
    issuer__type,
    lines__object,
    lines__has_more,
    lines__total_count,
    lines__url,
    livemode,
    number,
    paid,
    paid_out_of_band,
    payment_intent,
    period_end,
    period_start,
    post_payment_credit_notes_amount,
    pre_payment_credit_notes_amount,
    starting_balance,
    status,
    status_transitions__finalized_at,
    status_transitions__paid_at,
    subscription,
    subtotal,
    subtotal_excluding_tax,
    total,
    total_excluding_tax,
    webhooks_delivered_at,
    _dlt_load_id,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`invoice`

/* we only load table items of the currently active load ids into the staging table */
WHERE _dlt_load_id IN ( SELECT load_id FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids` )
    );
  
[0m02:44:49.709875 [info ] [Thread-4 (]: 3 of 50 OK created sql table model stripe_tst_2_transformed.stg_balance_transaction  [[32mCREATE TABLE (510.0 rows, 108.2 KiB processed)[0m in 3.40s]
[0m02:44:49.713156 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.stg_balance_transaction
[0m02:44:49.714379 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.stg_product
[0m02:44:49.716825 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_price"
[0m02:44:49.718235 [info ] [Thread-4 (]: 9 of 50 START sql table model stripe_tst_2_transformed.stg_product ............. [RUN]
[0m02:44:49.720777 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.stg_price
[0m02:44:49.722720 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_balance_transaction, now model.stripe_analytics_tst2.stg_product)
[0m02:44:49.734300 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_price"
[0m02:44:49.739138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:49.738010 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.stg_product
[0m02:44:49.752399 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_product"
[0m02:44:49.754028 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.stg_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_price"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_price`
      
    
    

    OPTIONS()
    as (
      /* Table: price */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table 'price' */
    id,
    object,
    active,
    billing_scheme,
    created,
    currency,
    livemode,
    product,
    recurring__interval,
    recurring__interval_count,
    recurring__usage_type,
    tax_behavior,
    type,
    unit_amount,
    unit_amount_decimal,
    _dlt_load_id,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`price`

/* we only load table items of the currently active load ids into the staging table */
WHERE _dlt_load_id IN ( SELECT load_id FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids` )
    );
  
[0m02:44:49.759352 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.stg_product
[0m02:44:49.795006 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_product"
[0m02:44:49.796263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:49.797793 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.stg_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_product"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_product`
      
    
    

    OPTIONS()
    as (
      /* Table: product */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table 'product' */
    id,
    object,
    active,
    created,
    description,
    livemode,
    name,
    type,
    updated,
    _dlt_load_id,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`product`

/* we only load table items of the currently active load ids into the staging table */
WHERE _dlt_load_id IN ( SELECT load_id FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids` )
    );
  
[0m02:44:50.361814 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:5eecb3c1-9f69-4bb1-bbf9-32050f4baae7&page=queryresults
[0m02:44:50.560136 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:20231f92-eff6-46c2-a973-d9cbdf97e5d1&page=queryresults
[0m02:44:50.803118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:a838493c-0520-4013-b870-5b615d2c601b&page=queryresults
[0m02:44:50.860325 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:b1175151-dd83-4811-ae79-e07f4b11fb11&page=queryresults
[0m02:44:52.834941 [info ] [Thread-2 (]: 6 of 50 OK created sql table model stripe_tst_2_transformed.stg_event .......... [[32mCREATE TABLE (21.0 rows, 15.3 KiB processed)[0m in 3.31s]
[0m02:44:52.835810 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.stg_event
[0m02:44:52.836430 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.stg_subscription
[0m02:44:52.837324 [info ] [Thread-2 (]: 10 of 50 START sql table model stripe_tst_2_transformed.stg_subscription ....... [RUN]
[0m02:44:52.838151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event, now model.stripe_analytics_tst2.stg_subscription)
[0m02:44:52.838712 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.stg_subscription
[0m02:44:52.842364 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_subscription"
[0m02:44:52.843086 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.stg_subscription
[0m02:44:52.845810 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_subscription"
[0m02:44:52.846537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:52.848038 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.stg_subscription: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_subscription"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription`
      
    
    

    OPTIONS()
    as (
      /* Table: subscription */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`

SELECT
/* select which columns will be available for table 'subscription' */
    id,
    object,
    automatic_tax__enabled,
    billing_cycle_anchor,
    cancel_at_period_end,
    collection_method,
    created,
    currency,
    current_period_end,
    current_period_start,
    customer,
    discount__id,
    discount__object,
    discount__coupon__id,
    discount__coupon__object,
    discount__coupon__created,
    discount__coupon__duration,
    discount__coupon__livemode,
    discount__coupon__percent_off,
    discount__coupon__times_redeemed,
    discount__coupon__valid,
    discount__customer,
    discount__start,
    discount__subscription,
    invoice_settings__issuer__type,
    items__object,
    items__has_more,
    items__total_count,
    items__url,
    latest_invoice,
    livemode,
    payment_settings__save_default_payment_method,
    plan__id,
    plan__object,
    plan__active,
    plan__amount,
    plan__amount_decimal,
    plan__billing_scheme,
    plan__created,
    plan__currency,
    plan__interval,
    plan__interval_count,
    plan__livemode,
    plan__product,
    plan__usage_type,
    quantity,
    start_date,
    status,
    trial_settings__end_behavior__missing_payment_method,
    _dlt_load_id,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`subscription`

/* we only load table items of the currently active load ids into the staging table */
WHERE _dlt_load_id IN ( SELECT load_id FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids` )
    );
  
[0m02:44:53.320307 [info ] [Thread-3 (]: 8 of 50 OK created sql table model stripe_tst_2_transformed.stg_price .......... [[32mCREATE TABLE (12.0 rows, 2.2 KiB processed)[0m in 3.65s]
[0m02:44:53.321153 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.stg_price
[0m02:44:53.321786 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.dim_coupon
[0m02:44:53.322618 [info ] [Thread-3 (]: 11 of 50 START sql incremental model stripe_tst_2_transformed.dim_coupon ....... [RUN]
[0m02:44:53.323202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_price, now model.stripe_analytics_tst2.dim_coupon)
[0m02:44:53.323737 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.dim_coupon
[0m02:44:53.327017 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_coupon"
[0m02:44:53.327825 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.dim_coupon
[0m02:44:53.361804 [info ] [Thread-4 (]: 9 of 50 OK created sql table model stripe_tst_2_transformed.stg_product ........ [[32mCREATE TABLE (12.0 rows, 1.9 KiB processed)[0m in 3.64s]
[0m02:44:53.372215 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.stg_product
[0m02:44:53.373076 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_coupon"
[0m02:44:53.373757 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.dim_customer
[0m02:44:53.374820 [info ] [Thread-4 (]: 12 of 50 START sql incremental model stripe_tst_2_transformed.dim_customer ..... [RUN]
[0m02:44:53.375492 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_product, now model.stripe_analytics_tst2.dim_customer)
[0m02:44:53.376018 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:53.376591 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.dim_customer
[0m02:44:53.378057 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.dim_coupon: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_coupon"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_coupon`
      
    
    

    OPTIONS()
    as (
      /* Table: coupon */

SELECT
    t.id,
    t.object,
    t.created,
    t.duration,
    t.livemode,
    t.percent_off,
    t.times_redeemed,
    t.valid,
    t._dlt_load_id,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_coupon` as t
    );
  
[0m02:44:53.381087 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_customer"
[0m02:44:53.411907 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.dim_customer
[0m02:44:53.416007 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_customer"
[0m02:44:53.416738 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:53.418517 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_customer"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      /* Table: customer */

SELECT
    t.id,
    t.object,
    t.balance,
    t.created,
    t.currency,
    t.delinquent,
    t.email,
    t.invoice_prefix,
    t.invoice_settings__default_payment_method,
    t.livemode,
    t.name,
    t.tax_exempt,
    t._dlt_load_id,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_customer` as t
    );
  
[0m02:44:53.643494 [info ] [Thread-1 (]: 7 of 50 OK created sql table model stripe_tst_2_transformed.stg_invoice ........ [[32mCREATE TABLE (17.0 rows, 15.6 KiB processed)[0m in 3.99s]
[0m02:44:53.644356 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.stg_invoice
[0m02:44:53.645014 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.dim__dlt_loads
[0m02:44:53.645842 [info ] [Thread-1 (]: 13 of 50 START sql incremental model stripe_tst_2_transformed.dim__dlt_loads ... [RUN]
[0m02:44:53.646497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_invoice, now model.stripe_analytics_tst2.dim__dlt_loads)
[0m02:44:53.647069 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.dim__dlt_loads
[0m02:44:53.650358 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim__dlt_loads"
[0m02:44:53.651135 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.dim__dlt_loads
[0m02:44:53.654864 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim__dlt_loads"
[0m02:44:53.656432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:53.658224 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.dim__dlt_loads: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim__dlt_loads"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim__dlt_loads`
      
    
    

    OPTIONS()
    as (
      /* Table: _dlt_loads */

/* Description: Created by DLT. Tracks completed loads */
SELECT
    t.load_id,
    t.schema_name,
    t.status,
    t.inserted_at,
    t.schema_version_hash,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg__dlt_loads` as t
    );
  
[0m02:44:54.046427 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:e2085ca4-7bf1-493f-868e-db2788216755&page=queryresults
[0m02:44:54.191062 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:ec40e0f1-7ecd-4a95-81f5-330e6fb13bdd&page=queryresults
[0m02:44:54.312199 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:d95145e6-7284-4324-86b3-b45acb25f608&page=queryresults
[0m02:44:54.438513 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:0ea88d11-59a8-44ae-85c0-6e9c8254f1db&page=queryresults
[0m02:44:56.385922 [info ] [Thread-3 (]: 11 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_coupon .. [[32mCREATE TABLE (4.0 rows, 384.0 Bytes processed)[0m in 3.06s]
[0m02:44:56.386860 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.dim_coupon
[0m02:44:56.387490 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.fact_balance_transaction
[0m02:44:56.388201 [info ] [Thread-3 (]: 14 of 50 START sql incremental model stripe_tst_2_transformed.fact_balance_transaction  [RUN]
[0m02:44:56.388786 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_coupon, now model.stripe_analytics_tst2.fact_balance_transaction)
[0m02:44:56.389341 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.fact_balance_transaction
[0m02:44:56.392579 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.fact_balance_transaction"
[0m02:44:56.393298 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.fact_balance_transaction
[0m02:44:56.396549 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.fact_balance_transaction"
[0m02:44:56.397286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:56.399289 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.fact_balance_transaction: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.fact_balance_transaction"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`fact_balance_transaction`
      
    
    

    OPTIONS()
    as (
      /* Fact Table: balance_transaction */


SELECT
    ---- main table balance_transaction
    balance_transaction.id,
    balance_transaction.object,
    balance_transaction.amount,
    balance_transaction.available_on,
    balance_transaction.created,
    balance_transaction.currency,
    balance_transaction.description,
    balance_transaction.fee,
    balance_transaction.net,
    balance_transaction.reporting_category,
    balance_transaction.status,
    balance_transaction.type,
    balance_transaction.exchange_rate,
    balance_transaction.source,

    

FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_balance_transaction` as balance_transaction
    );
  
[0m02:44:56.600554 [info ] [Thread-1 (]: 13 of 50 OK created sql incremental model stripe_tst_2_transformed.dim__dlt_loads  [[32mCREATE TABLE (1.0 rows, 97.0 Bytes processed)[0m in 2.95s]
[0m02:44:56.601372 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.dim__dlt_loads
[0m02:44:56.602014 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.stg_balance_transaction__fee_details
[0m02:44:56.602770 [info ] [Thread-1 (]: 15 of 50 START sql table model stripe_tst_2_transformed.stg_balance_transaction__fee_details  [RUN]
[0m02:44:56.603363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim__dlt_loads, now model.stripe_analytics_tst2.stg_balance_transaction__fee_details)
[0m02:44:56.603916 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.stg_balance_transaction__fee_details
[0m02:44:56.607776 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_balance_transaction__fee_details"
[0m02:44:56.608508 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.stg_balance_transaction__fee_details
[0m02:44:56.611201 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_balance_transaction__fee_details"
[0m02:44:56.611924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:56.613361 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.stg_balance_transaction__fee_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_balance_transaction__fee_details"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_balance_transaction__fee_details`
      
    
    

    OPTIONS()
    as (
      /* Table: balance_transaction__fee_details */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_balance_transaction`

SELECT
/* select which columns will be available for table 'balance_transaction__fee_details' */
    amount,
    currency,
    description,
    type,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`balance_transaction__fee_details`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_balance_transaction` )
    );
  
[0m02:44:56.779097 [info ] [Thread-4 (]: 12 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_customer  [[32mCREATE TABLE (300.0 rows, 51.6 KiB processed)[0m in 3.40s]
[0m02:44:56.779902 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.dim_customer
[0m02:44:56.780528 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.fact_event
[0m02:44:56.781238 [info ] [Thread-4 (]: 16 of 50 START sql incremental model stripe_tst_2_transformed.fact_event ....... [RUN]
[0m02:44:56.781824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_customer, now model.stripe_analytics_tst2.fact_event)
[0m02:44:56.782421 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.fact_event
[0m02:44:56.788896 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.fact_event"
[0m02:44:56.789687 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.fact_event
[0m02:44:56.792971 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.fact_event"
[0m02:44:56.793692 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:44:56.795356 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.fact_event: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.fact_event"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`fact_event`
      
    
    

    OPTIONS()
    as (
      /* Fact Table: event */


SELECT
    ---- main table event
    event.id,
    event.object,
    event.api_version,
    event.created,
    event.data__object__object,
    event.data__object__account_country,
    event.data__object__amount_due,
    event.data__object__amount_paid,
    event.data__object__amount_remaining,
    event.data__object__amount_shipping,
    event.data__object__attempt_count,
    event.data__object__attempted,
    event.data__object__automatic_tax__enabled,
    event.data__object__billing_reason,
    event.data__object__collection_method,
    event.data__object__created,
    event.data__object__currency,
    event.data__object__customer,
    event.data__object__customer_email,
    event.data__object__customer_name,
    event.data__object__customer_tax_exempt,
    event.data__object__discount__id,
    event.data__object__discount__object,
    event.data__object__discount__coupon__id,
    event.data__object__discount__coupon__object,
    event.data__object__discount__coupon__created,
    event.data__object__discount__coupon__duration,
    event.data__object__discount__coupon__livemode,
    event.data__object__discount__coupon__percent_off,
    event.data__object__discount__coupon__times_redeemed,
    event.data__object__discount__coupon__valid,
    event.data__object__discount__customer,
    event.data__object__discount__start,
    event.data__object__discount__subscription,
    event.data__object__ending_balance,
    event.data__object__issuer__type,
    event.data__object__lines__object,
    event.data__object__lines__has_more,
    event.data__object__lines__total_count,
    event.data__object__lines__url,
    event.data__object__livemode,
    event.data__object__next_payment_attempt,
    event.data__object__paid,
    event.data__object__paid_out_of_band,
    event.data__object__period_end,
    event.data__object__period_start,
    event.data__object__post_payment_credit_notes_amount,
    event.data__object__pre_payment_credit_notes_amount,
    event.data__object__starting_balance,
    event.data__object__status,
    event.data__object__subscription,
    event.data__object__subtotal,
    event.data__object__subtotal_excluding_tax,
    event.data__object__total,
    event.data__object__total_excluding_tax,
    event.livemode,
    event.pending_webhooks,
    event.type,
    event.data__object__id,
    event.data__object__auto_advance,
    event.data__object__charge,
    event.data__object__effective_at,
    event.data__object__hosted_invoice_url,
    event.data__object__invoice_pdf,
    event.data__object__number,
    event.data__object__payment_intent,
    event.data__object__status_transitions__finalized_at,
    event.data__object__status_transitions__paid_at,
    event.data__object__webhooks_delivered_at,
    event.data__previous_attributes__amount_paid,
    event.data__previous_attributes__amount_remaining,
    event.data__previous_attributes__attempt_count,
    event.data__previous_attributes__attempted,
    event.data__previous_attributes__auto_advance,
    event.data__previous_attributes__automatically_finalizes_at,
    event.data__previous_attributes__next_payment_attempt,
    event.data__previous_attributes__paid,
    event.data__previous_attributes__status,
    event.data__object__amount,
    event.data__object__amount_capturable,
    event.data__object__amount_received,
    event.data__object__capture_method,
    event.data__object__client_secret,
    event.data__object__confirmation_method,
    event.data__object__description,
    event.data__object__invoice,
    event.data__object__payment_method_options__card__request_three_d_secure,
    event.data__object__latest_charge,
    event.data__object__payment_method,
    event.request__idempotency_key,
    event.data__object__amount_captured,
    event.data__object__amount_refunded,
    event.data__object__balance_transaction,
    event.data__object__calculated_statement_descriptor,
    event.data__object__captured,
    event.data__object__disputed,
    event.data__object__outcome__network_status,
    event.data__object__outcome__risk_level,
    event.data__object__outcome__risk_score,
    event.data__object__outcome__seller_message,
    event.data__object__outcome__type,
    event.data__object__payment_method_details__card__amount_authorized,
    event.data__object__payment_method_details__card__brand,
    event.data__object__payment_method_details__card__country,
    event.data__object__payment_method_details__card__exp_month,
    event.data__object__payment_method_details__card__exp_year,
    event.data__object__payment_method_details__card__extended_authorization__status,
    event.data__object__payment_method_details__card__fingerprint,
    event.data__object__payment_method_details__card__funding,
    event.data__object__payment_method_details__card__incremental_authorization__status,
    event.data__object__payment_method_details__card__last4,
    event.data__object__payment_method_details__card__multicapture__status,
    event.data__object__payment_method_details__card__network,
    event.data__object__payment_method_details__card__network_token__used,
    event.data__object__payment_method_details__card__overcapture__maximum_amount_capturable,
    event.data__object__payment_method_details__card__overcapture__status,
    event.data__object__payment_method_details__type,
    event.data__object__receipt_url,
    event.data__object__refunded,
    event.data__object__billing_cycle_anchor,
    event.data__object__cancel_at_period_end,
    event.data__object__current_period_end,
    event.data__object__current_period_start,
    event.data__object__invoice_settings__issuer__type,
    event.data__object__items__object,
    event.data__object__items__has_more,
    event.data__object__items__total_count,
    event.data__object__items__url,
    event.data__object__latest_invoice,
    event.data__object__payment_settings__save_default_payment_method,
    event.data__object__plan__id,
    event.data__object__plan__object,
    event.data__object__plan__active,
    event.data__object__plan__amount,
    event.data__object__plan__amount_decimal,
    event.data__object__plan__billing_scheme,
    event.data__object__plan__created,
    event.data__object__plan__currency,
    event.data__object__plan__interval,
    event.data__object__plan__interval_count,
    event.data__object__plan__livemode,
    event.data__object__plan__product,
    event.data__object__plan__usage_type,
    event.data__object__quantity,
    event.data__object__start_date,
    event.data__object__trial_settings__end_behavior__missing_payment_method,
    event.data__previous_attributes__current_period_end,
    event.data__previous_attributes__current_period_start,
    event.data__previous_attributes__latest_invoice,
    event.data__object__automatically_finalizes_at,

    

FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` as event
    );
  
[0m02:44:56.859183 [info ] [Thread-2 (]: 10 of 50 OK created sql table model stripe_tst_2_transformed.stg_subscription .. [[32mCREATE TABLE (3.0 rows, 1.5 KiB processed)[0m in 4.02s]
[0m02:44:56.859959 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.stg_subscription
[0m02:44:56.860576 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.stg_event__data__object__available
[0m02:44:56.861384 [info ] [Thread-2 (]: 17 of 50 START sql table model stripe_tst_2_transformed.stg_event__data__object__available  [RUN]
[0m02:44:56.861983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_subscription, now model.stripe_analytics_tst2.stg_event__data__object__available)
[0m02:44:56.862573 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.stg_event__data__object__available
[0m02:44:56.866262 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event__data__object__available"
[0m02:44:56.866943 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.stg_event__data__object__available
[0m02:44:56.869508 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event__data__object__available"
[0m02:44:56.870236 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:44:56.871625 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.stg_event__data__object__available: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event__data__object__available"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__available`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__available */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event`

SELECT
/* select which columns will be available for table 'event__data__object__available' */
    amount,
    currency,
    source_types__card,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`event__data__object__available`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` )
    );
  
[0m02:44:57.296372 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:f15d9414-4ff4-4fbd-b975-554a1f1c4c0a&page=queryresults
[0m02:44:57.444995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:7e407679-6d63-42d8-8bca-78a59bea53fd&page=queryresults
[0m02:44:57.665321 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:e802fb2d-ded9-46c7-9aa9-2ad421581950&page=queryresults
[0m02:44:57.913884 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:bb919fbf-2f3e-489a-aee4-8f17d6fc2840&page=queryresults
[0m02:44:59.777849 [info ] [Thread-3 (]: 14 of 50 OK created sql incremental model stripe_tst_2_transformed.fact_balance_transaction  [[32mCREATE TABLE (510.0 rows, 90.2 KiB processed)[0m in 3.39s]
[0m02:44:59.778787 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.fact_balance_transaction
[0m02:44:59.779424 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.stg_event__data__object__discounts
[0m02:44:59.780159 [info ] [Thread-3 (]: 18 of 50 START sql table model stripe_tst_2_transformed.stg_event__data__object__discounts  [RUN]
[0m02:44:59.780896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.fact_balance_transaction, now model.stripe_analytics_tst2.stg_event__data__object__discounts)
[0m02:44:59.781461 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.stg_event__data__object__discounts
[0m02:44:59.785221 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event__data__object__discounts"
[0m02:44:59.785979 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.stg_event__data__object__discounts
[0m02:44:59.788809 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event__data__object__discounts"
[0m02:44:59.789531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:44:59.791016 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.stg_event__data__object__discounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event__data__object__discounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__discounts`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__discounts */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event`

SELECT
/* select which columns will be available for table 'event__data__object__discounts' */
    value,
    _dlt_id,
    _dlt_parent_id,
    _dlt_list_idx,
FROM `dlt-dev-external`.`stripe_tst_2`.`event__data__object__discounts`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` )
    );
  
[0m02:45:00.116612 [info ] [Thread-4 (]: 16 of 50 OK created sql incremental model stripe_tst_2_transformed.fact_event .. [[32mCREATE TABLE (21.0 rows, 14.6 KiB processed)[0m in 3.33s]
[0m02:45:00.117478 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.fact_event
[0m02:45:00.118157 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.stg_event__data__object__items__data
[0m02:45:00.118874 [info ] [Thread-4 (]: 19 of 50 START sql table model stripe_tst_2_transformed.stg_event__data__object__items__data  [RUN]
[0m02:45:00.119483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.fact_event, now model.stripe_analytics_tst2.stg_event__data__object__items__data)
[0m02:45:00.120056 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.stg_event__data__object__items__data
[0m02:45:00.124182 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event__data__object__items__data"
[0m02:45:00.124919 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.stg_event__data__object__items__data
[0m02:45:00.127617 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event__data__object__items__data"
[0m02:45:00.128343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:00.129854 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.stg_event__data__object__items__data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event__data__object__items__data"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__items__data`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__items__data */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event`

SELECT
/* select which columns will be available for table 'event__data__object__items__data' */
    id,
    object,
    created,
    plan__id,
    plan__object,
    plan__active,
    plan__amount,
    plan__amount_decimal,
    plan__billing_scheme,
    plan__created,
    plan__currency,
    plan__interval,
    plan__interval_count,
    plan__livemode,
    plan__product,
    plan__usage_type,
    price__id,
    price__object,
    price__active,
    price__billing_scheme,
    price__created,
    price__currency,
    price__livemode,
    price__product,
    price__recurring__interval,
    price__recurring__interval_count,
    price__recurring__usage_type,
    price__tax_behavior,
    price__type,
    price__unit_amount,
    price__unit_amount_decimal,
    quantity,
    subscription,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`event__data__object__items__data`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` )
    );
  
[0m02:45:00.159032 [info ] [Thread-2 (]: 17 of 50 OK created sql table model stripe_tst_2_transformed.stg_event__data__object__available  [[32mCREATE TABLE (1.0 rows, 397.0 Bytes processed)[0m in 3.30s]
[0m02:45:00.160007 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.stg_event__data__object__available
[0m02:45:00.160679 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.stg_event__data__object__lines__data
[0m02:45:00.161429 [info ] [Thread-2 (]: 20 of 50 START sql table model stripe_tst_2_transformed.stg_event__data__object__lines__data  [RUN]
[0m02:45:00.162146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event__data__object__available, now model.stripe_analytics_tst2.stg_event__data__object__lines__data)
[0m02:45:00.162778 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.stg_event__data__object__lines__data
[0m02:45:00.168752 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event__data__object__lines__data"
[0m02:45:00.169537 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.stg_event__data__object__lines__data
[0m02:45:00.172305 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event__data__object__lines__data"
[0m02:45:00.173023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:45:00.174540 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.stg_event__data__object__lines__data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event__data__object__lines__data"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__lines__data`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__lines__data */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event`

SELECT
/* select which columns will be available for table 'event__data__object__lines__data' */
    id,
    object,
    amount,
    amount_excluding_tax,
    currency,
    description,
    discountable,
    livemode,
    period__end,
    period__start,
    plan__id,
    plan__object,
    plan__active,
    plan__amount,
    plan__amount_decimal,
    plan__billing_scheme,
    plan__created,
    plan__currency,
    plan__interval,
    plan__interval_count,
    plan__livemode,
    plan__product,
    plan__usage_type,
    price__id,
    price__object,
    price__active,
    price__billing_scheme,
    price__created,
    price__currency,
    price__livemode,
    price__product,
    price__recurring__interval,
    price__recurring__interval_count,
    price__recurring__usage_type,
    price__tax_behavior,
    price__type,
    price__unit_amount,
    price__unit_amount_decimal,
    proration,
    quantity,
    subscription,
    subscription_item,
    type,
    unit_amount_excluding_tax,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
    invoice,
FROM `dlt-dev-external`.`stripe_tst_2`.`event__data__object__lines__data`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` )
    );
  
[0m02:45:00.256376 [info ] [Thread-1 (]: 15 of 50 OK created sql table model stripe_tst_2_transformed.stg_balance_transaction__fee_details  [[32mCREATE TABLE (493.0 rows, 50.8 KiB processed)[0m in 3.65s]
[0m02:45:00.257159 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.stg_balance_transaction__fee_details
[0m02:45:00.257763 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.stg_event__data__object__payment_method_types
[0m02:45:00.258505 [info ] [Thread-1 (]: 21 of 50 START sql table model stripe_tst_2_transformed.stg_event__data__object__payment_method_types  [RUN]
[0m02:45:00.259186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_balance_transaction__fee_details, now model.stripe_analytics_tst2.stg_event__data__object__payment_method_types)
[0m02:45:00.259738 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.stg_event__data__object__payment_method_types
[0m02:45:00.263400 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event__data__object__payment_method_types"
[0m02:45:00.264098 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.stg_event__data__object__payment_method_types
[0m02:45:00.266802 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event__data__object__payment_method_types"
[0m02:45:00.267528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:00.268955 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.stg_event__data__object__payment_method_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event__data__object__payment_method_types"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__payment_method_types`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__payment_method_types */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event`

SELECT
/* select which columns will be available for table 'event__data__object__payment_method_types' */
    value,
    _dlt_id,
    _dlt_parent_id,
    _dlt_list_idx,
FROM `dlt-dev-external`.`stripe_tst_2`.`event__data__object__payment_method_types`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` )
    );
  
[0m02:45:00.557988 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:242dae0c-408c-4e39-8023-fb69b2056260&page=queryresults
[0m02:45:00.917660 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:61b00cba-8c22-47a4-a2d1-9312106c3c14&page=queryresults
[0m02:45:00.966453 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:381c0ea2-4ea4-4048-85fa-5a841d481976&page=queryresults
[0m02:45:01.019031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:63d15fe7-5a68-41d1-8e6a-1e7653748087&page=queryresults
[0m02:45:03.357683 [info ] [Thread-4 (]: 19 of 50 OK created sql table model stripe_tst_2_transformed.stg_event__data__object__items__data  [[32mCREATE TABLE (2.0 rows, 1.1 KiB processed)[0m in 3.24s]
[0m02:45:03.358597 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.stg_event__data__object__items__data
[0m02:45:03.359224 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.stg_event__data__object__pending
[0m02:45:03.359998 [info ] [Thread-4 (]: 22 of 50 START sql table model stripe_tst_2_transformed.stg_event__data__object__pending  [RUN]
[0m02:45:03.360594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event__data__object__items__data, now model.stripe_analytics_tst2.stg_event__data__object__pending)
[0m02:45:03.361170 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.stg_event__data__object__pending
[0m02:45:03.365657 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event__data__object__pending"
[0m02:45:03.367905 [info ] [Thread-3 (]: 18 of 50 OK created sql table model stripe_tst_2_transformed.stg_event__data__object__discounts  [[32mCREATE TABLE (7.0 rows, 819.0 Bytes processed)[0m in 3.59s]
[0m02:45:03.368522 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.stg_event__data__object__pending
[0m02:45:03.369195 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.stg_event__data__object__discounts
[0m02:45:03.371959 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event__data__object__pending"
[0m02:45:03.372636 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts
[0m02:45:03.373575 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:03.374194 [info ] [Thread-3 (]: 23 of 50 START sql table model stripe_tst_2_transformed.stg_event__data__object__total_discount_amounts  [RUN]
[0m02:45:03.375698 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.stg_event__data__object__pending: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event__data__object__pending"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__pending`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__pending */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event`

SELECT
/* select which columns will be available for table 'event__data__object__pending' */
    amount,
    currency,
    source_types__card,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`event__data__object__pending`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` )
    );
  
[0m02:45:03.376359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event__data__object__discounts, now model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts)
[0m02:45:03.402516 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts
[0m02:45:03.406713 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts"
[0m02:45:03.407622 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts
[0m02:45:03.410363 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts"
[0m02:45:03.411105 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:45:03.412530 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__total_discount_amounts`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__total_discount_amounts */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event`

SELECT
/* select which columns will be available for table 'event__data__object__total_discount_amounts' */
    amount,
    discount,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`event__data__object__total_discount_amounts`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` )
    );
  
[0m02:45:03.440186 [info ] [Thread-2 (]: 20 of 50 OK created sql table model stripe_tst_2_transformed.stg_event__data__object__lines__data  [[32mCREATE TABLE (12.0 rows, 6.7 KiB processed)[0m in 3.28s]
[0m02:45:03.441802 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.stg_event__data__object__lines__data
[0m02:45:03.442790 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.dim_price
[0m02:45:03.443666 [info ] [Thread-2 (]: 24 of 50 START sql incremental model stripe_tst_2_transformed.dim_price ........ [RUN]
[0m02:45:03.444299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event__data__object__lines__data, now model.stripe_analytics_tst2.dim_price)
[0m02:45:03.444845 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.dim_price
[0m02:45:03.448291 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_price"
[0m02:45:03.449028 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.dim_price
[0m02:45:03.454113 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_price"
[0m02:45:03.454823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:45:03.456235 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.dim_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_price"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_price`
      
    
    

    OPTIONS()
    as (
      /* Table: price */

SELECT
    t.id,
    t.object,
    t.active,
    t.billing_scheme,
    t.created,
    t.currency,
    t.livemode,
    t.product,
    t.recurring__interval,
    t.recurring__interval_count,
    t.recurring__usage_type,
    t.tax_behavior,
    t.type,
    t.unit_amount,
    t.unit_amount_decimal,
    t._dlt_load_id,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_price` as t
    );
  
[0m02:45:04.121671 [info ] [Thread-1 (]: 21 of 50 OK created sql table model stripe_tst_2_transformed.stg_event__data__object__payment_method_types  [[32mCREATE TABLE (8.0 rows, 712.0 Bytes processed)[0m in 3.86s]
[0m02:45:04.122630 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.stg_event__data__object__payment_method_types
[0m02:45:04.123267 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.dim_product
[0m02:45:04.124056 [info ] [Thread-1 (]: 25 of 50 START sql incremental model stripe_tst_2_transformed.dim_product ...... [RUN]
[0m02:45:04.124700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event__data__object__payment_method_types, now model.stripe_analytics_tst2.dim_product)
[0m02:45:04.125254 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.dim_product
[0m02:45:04.128578 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_product"
[0m02:45:04.129309 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.dim_product
[0m02:45:04.133971 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_product"
[0m02:45:04.134744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:04.136706 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_product"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_product`
      
    
    

    OPTIONS()
    as (
      /* Table: product */

SELECT
    t.id,
    t.object,
    t.active,
    t.created,
    t.description,
    t.livemode,
    t.name,
    t.type,
    t.updated,
    t._dlt_load_id,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_product` as t
    );
  
[0m02:45:04.163807 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:f3a8bd14-23f8-4659-b49a-1fd4ba16c014&page=queryresults
[0m02:45:04.223606 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:630337c9-b7d9-41c2-b55c-5ba646691de4&page=queryresults
[0m02:45:04.311135 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:e2be28fc-23cc-41f2-95a0-663e70456d46&page=queryresults
[0m02:45:04.904556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:8430262b-a559-429d-a7df-06b2b8a96472&page=queryresults
[0m02:45:06.641299 [info ] [Thread-4 (]: 22 of 50 OK created sql table model stripe_tst_2_transformed.stg_event__data__object__pending  [[32mCREATE TABLE (1.0 rows, 397.0 Bytes processed)[0m in 3.28s]
[0m02:45:06.642218 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.stg_event__data__object__pending
[0m02:45:06.642878 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.fact_invoice
[0m02:45:06.643661 [info ] [Thread-4 (]: 26 of 50 START sql incremental model stripe_tst_2_transformed.fact_invoice ..... [RUN]
[0m02:45:06.644303 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event__data__object__pending, now model.stripe_analytics_tst2.fact_invoice)
[0m02:45:06.644879 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.fact_invoice
[0m02:45:06.648375 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.fact_invoice"
[0m02:45:06.649075 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.fact_invoice
[0m02:45:06.652460 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.fact_invoice"
[0m02:45:06.653158 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:06.654657 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.fact_invoice: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.fact_invoice"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`fact_invoice`
      
    
    

    OPTIONS()
    as (
      /* Fact Table: invoice */


SELECT
    ---- main table invoice
    invoice.id,
    invoice.object,
    invoice.account_country,
    invoice.amount_due,
    invoice.amount_paid,
    invoice.amount_remaining,
    invoice.amount_shipping,
    invoice.attempt_count,
    invoice.attempted,
    invoice.auto_advance,
    invoice.automatic_tax__enabled,
    invoice.billing_reason,
    invoice.charge,
    invoice.collection_method,
    invoice.created,
    invoice.currency,
    invoice.customer,
    invoice.customer_email,
    invoice.customer_name,
    invoice.customer_tax_exempt,
    invoice.discount__id,
    invoice.discount__object,
    invoice.discount__coupon__id,
    invoice.discount__coupon__object,
    invoice.discount__coupon__created,
    invoice.discount__coupon__duration,
    invoice.discount__coupon__livemode,
    invoice.discount__coupon__percent_off,
    invoice.discount__coupon__times_redeemed,
    invoice.discount__coupon__valid,
    invoice.discount__customer,
    invoice.discount__start,
    invoice.discount__subscription,
    invoice.effective_at,
    invoice.ending_balance,
    invoice.hosted_invoice_url,
    invoice.invoice_pdf,
    invoice.issuer__type,
    invoice.lines__object,
    invoice.lines__has_more,
    invoice.lines__total_count,
    invoice.lines__url,
    invoice.livemode,
    invoice.number,
    invoice.paid,
    invoice.paid_out_of_band,
    invoice.payment_intent,
    invoice.period_end,
    invoice.period_start,
    invoice.post_payment_credit_notes_amount,
    invoice.pre_payment_credit_notes_amount,
    invoice.starting_balance,
    invoice.status,
    invoice.status_transitions__finalized_at,
    invoice.status_transitions__paid_at,
    invoice.subscription,
    invoice.subtotal,
    invoice.subtotal_excluding_tax,
    invoice.total,
    invoice.total_excluding_tax,
    invoice.webhooks_delivered_at,

    

FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice` as invoice
    );
  
[0m02:45:06.697776 [info ] [Thread-3 (]: 23 of 50 OK created sql table model stripe_tst_2_transformed.stg_event__data__object__total_discount_amounts  [[32mCREATE TABLE (6.0 rows, 798.0 Bytes processed)[0m in 3.32s]
[0m02:45:06.698545 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts
[0m02:45:06.699169 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.stg_invoice__discounts
[0m02:45:06.699889 [info ] [Thread-3 (]: 27 of 50 START sql table model stripe_tst_2_transformed.stg_invoice__discounts . [RUN]
[0m02:45:06.700506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event__data__object__total_discount_amounts, now model.stripe_analytics_tst2.stg_invoice__discounts)
[0m02:45:06.701051 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.stg_invoice__discounts
[0m02:45:06.704559 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_invoice__discounts"
[0m02:45:06.705222 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.stg_invoice__discounts
[0m02:45:06.707870 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_invoice__discounts"
[0m02:45:06.708566 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:45:06.709913 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.stg_invoice__discounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_invoice__discounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__discounts`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice__discounts */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice`

SELECT
/* select which columns will be available for table 'invoice__discounts' */
    value,
    _dlt_id,
    _dlt_parent_id,
    _dlt_list_idx,
FROM `dlt-dev-external`.`stripe_tst_2`.`invoice__discounts`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice` )
    );
  
[0m02:45:06.738268 [info ] [Thread-2 (]: 24 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_price ... [[32mCREATE TABLE (12.0 rows, 2.2 KiB processed)[0m in 3.29s]
[0m02:45:06.739162 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.dim_price
[0m02:45:06.739797 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.stg_invoice__lines__data
[0m02:45:06.740543 [info ] [Thread-2 (]: 28 of 50 START sql table model stripe_tst_2_transformed.stg_invoice__lines__data  [RUN]
[0m02:45:06.741176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_price, now model.stripe_analytics_tst2.stg_invoice__lines__data)
[0m02:45:06.741735 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.stg_invoice__lines__data
[0m02:45:06.745605 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_invoice__lines__data"
[0m02:45:06.746432 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.stg_invoice__lines__data
[0m02:45:06.749200 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_invoice__lines__data"
[0m02:45:06.750064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:45:06.751780 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.stg_invoice__lines__data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_invoice__lines__data"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__lines__data`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice__lines__data */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice`

SELECT
/* select which columns will be available for table 'invoice__lines__data' */
    id,
    object,
    amount,
    amount_excluding_tax,
    currency,
    description,
    discountable,
    invoice,
    livemode,
    period__end,
    period__start,
    plan__id,
    plan__object,
    plan__active,
    plan__amount,
    plan__amount_decimal,
    plan__billing_scheme,
    plan__created,
    plan__currency,
    plan__interval,
    plan__interval_count,
    plan__livemode,
    plan__product,
    plan__usage_type,
    price__id,
    price__object,
    price__active,
    price__billing_scheme,
    price__created,
    price__currency,
    price__livemode,
    price__product,
    price__recurring__interval,
    price__recurring__interval_count,
    price__recurring__usage_type,
    price__tax_behavior,
    price__type,
    price__unit_amount,
    price__unit_amount_decimal,
    proration,
    quantity,
    subscription,
    subscription_item,
    type,
    unit_amount_excluding_tax,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`invoice__lines__data`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice` )
    );
  
[0m02:45:07.356650 [info ] [Thread-1 (]: 25 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_product . [[32mCREATE TABLE (12.0 rows, 1.8 KiB processed)[0m in 3.23s]
[0m02:45:07.357578 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.dim_product
[0m02:45:07.358242 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.stg_invoice__total_discount_amounts
[0m02:45:07.358977 [info ] [Thread-1 (]: 29 of 50 START sql table model stripe_tst_2_transformed.stg_invoice__total_discount_amounts  [RUN]
[0m02:45:07.359575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_product, now model.stripe_analytics_tst2.stg_invoice__total_discount_amounts)
[0m02:45:07.360146 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.stg_invoice__total_discount_amounts
[0m02:45:07.366058 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_invoice__total_discount_amounts"
[0m02:45:07.366883 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.stg_invoice__total_discount_amounts
[0m02:45:07.459913 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:3710419a-24b7-40ec-90ad-a1741c3e8620&page=queryresults
[0m02:45:07.470637 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_invoice__total_discount_amounts"
[0m02:45:07.471455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.472942 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.stg_invoice__total_discount_amounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_invoice__total_discount_amounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__total_discount_amounts`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice__total_discount_amounts */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice`

SELECT
/* select which columns will be available for table 'invoice__total_discount_amounts' */
    amount,
    discount,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`invoice__total_discount_amounts`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice` )
    );
  
[0m02:45:07.501285 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:dc39a982-3ed9-41d0-9350-4ac8134328f0&page=queryresults
[0m02:45:07.504085 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:ce1ee848-bf01-43ae-9f0b-ff7731ac811b&page=queryresults
[0m02:45:08.196645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:554f145c-f28c-4a9c-a818-5ff151e25bad&page=queryresults
[0m02:45:09.947437 [info ] [Thread-3 (]: 27 of 50 OK created sql table model stripe_tst_2_transformed.stg_invoice__discounts  [[32mCREATE TABLE (8.0 rows, 824.0 Bytes processed)[0m in 3.25s]
[0m02:45:09.948309 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.stg_invoice__discounts
[0m02:45:09.948918 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.fact_subscription
[0m02:45:09.949708 [info ] [Thread-3 (]: 30 of 50 START sql incremental model stripe_tst_2_transformed.fact_subscription  [RUN]
[0m02:45:09.950341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_invoice__discounts, now model.stripe_analytics_tst2.fact_subscription)
[0m02:45:09.950894 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.fact_subscription
[0m02:45:09.954180 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.fact_subscription"
[0m02:45:09.954875 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.fact_subscription
[0m02:45:09.958176 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.fact_subscription"
[0m02:45:09.958876 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:45:09.960374 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.fact_subscription: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.fact_subscription"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`fact_subscription`
      
    
    

    OPTIONS()
    as (
      /* Fact Table: subscription */


SELECT
    ---- main table subscription
    subscription.id,
    subscription.object,
    subscription.automatic_tax__enabled,
    subscription.billing_cycle_anchor,
    subscription.cancel_at_period_end,
    subscription.collection_method,
    subscription.created,
    subscription.currency,
    subscription.current_period_end,
    subscription.current_period_start,
    subscription.customer,
    subscription.discount__id,
    subscription.discount__object,
    subscription.discount__coupon__id,
    subscription.discount__coupon__object,
    subscription.discount__coupon__created,
    subscription.discount__coupon__duration,
    subscription.discount__coupon__livemode,
    subscription.discount__coupon__percent_off,
    subscription.discount__coupon__times_redeemed,
    subscription.discount__coupon__valid,
    subscription.discount__customer,
    subscription.discount__start,
    subscription.discount__subscription,
    subscription.invoice_settings__issuer__type,
    subscription.items__object,
    subscription.items__has_more,
    subscription.items__total_count,
    subscription.items__url,
    subscription.latest_invoice,
    subscription.livemode,
    subscription.payment_settings__save_default_payment_method,
    subscription.plan__id,
    subscription.plan__object,
    subscription.plan__active,
    subscription.plan__amount,
    subscription.plan__amount_decimal,
    subscription.plan__billing_scheme,
    subscription.plan__created,
    subscription.plan__currency,
    subscription.plan__interval,
    subscription.plan__interval_count,
    subscription.plan__livemode,
    subscription.plan__product,
    subscription.plan__usage_type,
    subscription.quantity,
    subscription.start_date,
    subscription.status,
    subscription.trial_settings__end_behavior__missing_payment_method,

    

FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription` as subscription
    );
  
[0m02:45:10.648677 [info ] [Thread-2 (]: 28 of 50 OK created sql table model stripe_tst_2_transformed.stg_invoice__lines__data  [[32mCREATE TABLE (17.0 rows, 9.4 KiB processed)[0m in 3.91s]
[0m02:45:10.649592 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.stg_invoice__lines__data
[0m02:45:10.650250 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.stg_subscription__discounts
[0m02:45:10.651078 [info ] [Thread-2 (]: 31 of 50 START sql table model stripe_tst_2_transformed.stg_subscription__discounts  [RUN]
[0m02:45:10.651665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_invoice__lines__data, now model.stripe_analytics_tst2.stg_subscription__discounts)
[0m02:45:10.652233 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.stg_subscription__discounts
[0m02:45:10.656205 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_subscription__discounts"
[0m02:45:10.656940 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.stg_subscription__discounts
[0m02:45:10.659643 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_subscription__discounts"
[0m02:45:10.660383 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:45:10.661836 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.stg_subscription__discounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_subscription__discounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription__discounts`
      
    
    

    OPTIONS()
    as (
      /* Table: subscription__discounts */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription`

SELECT
/* select which columns will be available for table 'subscription__discounts' */
    value,
    _dlt_id,
    _dlt_parent_id,
    _dlt_list_idx,
FROM `dlt-dev-external`.`stripe_tst_2`.`subscription__discounts`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription` )
    );
  
[0m02:45:10.784651 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:6db5cd84-9a6f-4ab2-aef9-2a0e6299e2dc&page=queryresults
[0m02:45:10.982820 [info ] [Thread-1 (]: 29 of 50 OK created sql table model stripe_tst_2_transformed.stg_invoice__total_discount_amounts  [[32mCREATE TABLE (8.0 rows, 888.0 Bytes processed)[0m in 3.62s]
[0m02:45:10.983661 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.stg_invoice__total_discount_amounts
[0m02:45:10.984290 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.stg_subscription__items__data
[0m02:45:10.985061 [info ] [Thread-1 (]: 32 of 50 START sql table model stripe_tst_2_transformed.stg_subscription__items__data  [RUN]
[0m02:45:10.985666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_invoice__total_discount_amounts, now model.stripe_analytics_tst2.stg_subscription__items__data)
[0m02:45:10.986245 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.stg_subscription__items__data
[0m02:45:10.990238 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_subscription__items__data"
[0m02:45:10.990995 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.stg_subscription__items__data
[0m02:45:10.993786 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_subscription__items__data"
[0m02:45:10.994549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:10.996048 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.stg_subscription__items__data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_subscription__items__data"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription__items__data`
      
    
    

    OPTIONS()
    as (
      /* Table: subscription__items__data */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription`

SELECT
/* select which columns will be available for table 'subscription__items__data' */
    id,
    object,
    created,
    plan__id,
    plan__object,
    plan__active,
    plan__amount,
    plan__amount_decimal,
    plan__billing_scheme,
    plan__created,
    plan__currency,
    plan__interval,
    plan__interval_count,
    plan__livemode,
    plan__product,
    plan__usage_type,
    price__id,
    price__object,
    price__active,
    price__billing_scheme,
    price__created,
    price__currency,
    price__livemode,
    price__product,
    price__recurring__interval,
    price__recurring__interval_count,
    price__recurring__usage_type,
    price__tax_behavior,
    price__type,
    price__unit_amount,
    price__unit_amount_decimal,
    quantity,
    subscription,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`subscription__items__data`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription` )
    );
  
[0m02:45:11.056385 [info ] [Thread-4 (]: 26 of 50 OK created sql incremental model stripe_tst_2_transformed.fact_invoice  [[32mCREATE TABLE (17.0 rows, 15.0 KiB processed)[0m in 4.41s]
[0m02:45:11.057249 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.fact_invoice
[0m02:45:11.057867 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.dim_event__data__object__available
[0m02:45:11.058598 [info ] [Thread-4 (]: 33 of 50 START sql incremental model stripe_tst_2_transformed.dim_event__data__object__available  [RUN]
[0m02:45:11.059163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.fact_invoice, now model.stripe_analytics_tst2.dim_event__data__object__available)
[0m02:45:11.059719 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.dim_event__data__object__available
[0m02:45:11.063093 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_event__data__object__available"
[0m02:45:11.063811 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.dim_event__data__object__available
[0m02:45:11.068951 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_event__data__object__available"
[0m02:45:11.069771 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:11.071261 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.dim_event__data__object__available: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_event__data__object__available"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__available`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__available */
/* Parent: event */

SELECT
    t.amount,
    t.currency,
    t.source_types__card,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__available` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:11.375930 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:4e056925-c32b-477d-8d50-5964387d354a&page=queryresults
[0m02:45:11.807213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:dbdd6f53-dbe8-4460-8446-ac5051056d15&page=queryresults
[0m02:45:11.823830 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:ec3f927d-ad94-40cf-aca4-41a71ffc3fab&page=queryresults
[0m02:45:12.973760 [info ] [Thread-3 (]: 30 of 50 OK created sql incremental model stripe_tst_2_transformed.fact_subscription  [[32mCREATE TABLE (3.0 rows, 1.4 KiB processed)[0m in 3.02s]
[0m02:45:12.974711 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.fact_subscription
[0m02:45:12.975342 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.dim_balance_transaction__fee_details
[0m02:45:12.976077 [info ] [Thread-3 (]: 34 of 50 START sql incremental model stripe_tst_2_transformed.dim_balance_transaction__fee_details  [RUN]
[0m02:45:12.976660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.fact_subscription, now model.stripe_analytics_tst2.dim_balance_transaction__fee_details)
[0m02:45:12.977215 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.dim_balance_transaction__fee_details
[0m02:45:12.980695 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_balance_transaction__fee_details"
[0m02:45:12.981420 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.dim_balance_transaction__fee_details
[0m02:45:12.984766 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_balance_transaction__fee_details"
[0m02:45:12.985464 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:45:12.986930 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.dim_balance_transaction__fee_details: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_balance_transaction__fee_details"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_balance_transaction__fee_details`
      
    
    

    OPTIONS()
    as (
      /* Table: balance_transaction__fee_details */
/* Parent: balance_transaction */

SELECT
    t.amount,
    t.currency,
    t.description,
    t.type,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_balance_transaction__fee_details` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_balance_transaction` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:13.791526 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:82ae07fd-bfe7-44a0-b924-2072a77b99eb&page=queryresults
[0m02:45:13.876598 [info ] [Thread-2 (]: 31 of 50 OK created sql table model stripe_tst_2_transformed.stg_subscription__discounts  [[32mCREATE TABLE (1.0 rows, 117.0 Bytes processed)[0m in 3.22s]
[0m02:45:13.877921 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.stg_subscription__discounts
[0m02:45:13.879034 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.dim_event__data__object__items__data
[0m02:45:13.880246 [info ] [Thread-2 (]: 35 of 50 START sql incremental model stripe_tst_2_transformed.dim_event__data__object__items__data  [RUN]
[0m02:45:13.881205 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_subscription__discounts, now model.stripe_analytics_tst2.dim_event__data__object__items__data)
[0m02:45:13.882170 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.dim_event__data__object__items__data
[0m02:45:13.886387 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_event__data__object__items__data"
[0m02:45:13.887222 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.dim_event__data__object__items__data
[0m02:45:13.890603 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_event__data__object__items__data"
[0m02:45:13.891313 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:45:13.892782 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.dim_event__data__object__items__data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_event__data__object__items__data"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__items__data`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__items__data */
/* Parent: event */

SELECT
    t.id,
    t.object,
    t.created,
    t.plan__id,
    t.plan__object,
    t.plan__active,
    t.plan__amount,
    t.plan__amount_decimal,
    t.plan__billing_scheme,
    t.plan__created,
    t.plan__currency,
    t.plan__interval,
    t.plan__interval_count,
    t.plan__livemode,
    t.plan__product,
    t.plan__usage_type,
    t.price__id,
    t.price__object,
    t.price__active,
    t.price__billing_scheme,
    t.price__created,
    t.price__currency,
    t.price__livemode,
    t.price__product,
    t.price__recurring__interval,
    t.price__recurring__interval_count,
    t.price__recurring__usage_type,
    t.price__tax_behavior,
    t.price__type,
    t.price__unit_amount,
    t.price__unit_amount_decimal,
    t.quantity,
    t.subscription,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__items__data` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:14.565727 [info ] [Thread-4 (]: 33 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_event__data__object__available  [[32mCREATE TABLE (1.0 rows, 397.0 Bytes processed)[0m in 3.51s]
[0m02:45:14.566717 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.dim_event__data__object__available
[0m02:45:14.567366 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.dim_event__data__object__discounts
[0m02:45:14.568077 [info ] [Thread-4 (]: 36 of 50 START sql incremental model stripe_tst_2_transformed.dim_event__data__object__discounts  [RUN]
[0m02:45:14.568657 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_event__data__object__available, now model.stripe_analytics_tst2.dim_event__data__object__discounts)
[0m02:45:14.569231 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.dim_event__data__object__discounts
[0m02:45:14.572761 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_event__data__object__discounts"
[0m02:45:14.573491 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.dim_event__data__object__discounts
[0m02:45:14.576837 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_event__data__object__discounts"
[0m02:45:14.577546 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:14.579046 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.dim_event__data__object__discounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_event__data__object__discounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__discounts`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__discounts */
/* Parent: event */

SELECT
    t.value,
    t._dlt_id,
    t._dlt_parent_id,
    t._dlt_list_idx,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__discounts` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:14.655305 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:fbaee21c-7b69-45a8-a7fe-55c7f58fe12c&page=queryresults
[0m02:45:14.771164 [info ] [Thread-1 (]: 32 of 50 OK created sql table model stripe_tst_2_transformed.stg_subscription__items__data  [[32mCREATE TABLE (3.0 rows, 1.2 KiB processed)[0m in 3.79s]
[0m02:45:14.771957 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.stg_subscription__items__data
[0m02:45:14.772595 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.dim_event__data__object__lines__data
[0m02:45:14.773392 [info ] [Thread-1 (]: 37 of 50 START sql incremental model stripe_tst_2_transformed.dim_event__data__object__lines__data  [RUN]
[0m02:45:14.773995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_subscription__items__data, now model.stripe_analytics_tst2.dim_event__data__object__lines__data)
[0m02:45:14.774591 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.dim_event__data__object__lines__data
[0m02:45:14.777959 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_event__data__object__lines__data"
[0m02:45:14.778728 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.dim_event__data__object__lines__data
[0m02:45:14.784342 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_event__data__object__lines__data"
[0m02:45:14.785115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:14.786642 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.dim_event__data__object__lines__data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_event__data__object__lines__data"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__lines__data`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__lines__data */
/* Parent: event */

SELECT
    t.id,
    t.object,
    t.amount,
    t.amount_excluding_tax,
    t.currency,
    t.description,
    t.discountable,
    t.livemode,
    t.period__end,
    t.period__start,
    t.plan__id,
    t.plan__object,
    t.plan__active,
    t.plan__amount,
    t.plan__amount_decimal,
    t.plan__billing_scheme,
    t.plan__created,
    t.plan__currency,
    t.plan__interval,
    t.plan__interval_count,
    t.plan__livemode,
    t.plan__product,
    t.plan__usage_type,
    t.price__id,
    t.price__object,
    t.price__active,
    t.price__billing_scheme,
    t.price__created,
    t.price__currency,
    t.price__livemode,
    t.price__product,
    t.price__recurring__interval,
    t.price__recurring__interval_count,
    t.price__recurring__usage_type,
    t.price__tax_behavior,
    t.price__type,
    t.price__unit_amount,
    t.price__unit_amount_decimal,
    t.proration,
    t.quantity,
    t.subscription,
    t.subscription_item,
    t.type,
    t.unit_amount_excluding_tax,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
    t.invoice,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__lines__data` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:15.365292 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:31b8bd4e-2551-4602-80f5-88bf97fefe29&page=queryresults
[0m02:45:15.560558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:ca777c64-8c32-4a83-88a9-a75121eacfc3&page=queryresults
[0m02:45:16.981953 [info ] [Thread-3 (]: 34 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_balance_transaction__fee_details  [[32mCREATE TABLE (493.0 rows, 50.8 KiB processed)[0m in 4.01s]
[0m02:45:16.982898 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.dim_balance_transaction__fee_details
[0m02:45:16.983550 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts
[0m02:45:16.984270 [info ] [Thread-3 (]: 38 of 50 START sql table model stripe_tst_2_transformed.stg_event__data__object__lines__data__discount_amounts  [RUN]
[0m02:45:16.984852 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_balance_transaction__fee_details, now model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts)
[0m02:45:16.985412 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts
[0m02:45:16.989310 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts"
[0m02:45:16.990027 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts
[0m02:45:16.992802 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts"
[0m02:45:16.993515 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:45:16.994999 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__lines__data__discount_amounts`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__lines__data__discount_amounts */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__lines__data`

SELECT
/* select which columns will be available for table 'event__data__object__lines__data__discount_amounts' */
    amount,
    discount,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`event__data__object__lines__data__discount_amounts`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__lines__data` )
    );
  
[0m02:45:17.384814 [info ] [Thread-2 (]: 35 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_event__data__object__items__data  [[32mCREATE TABLE (2.0 rows, 1.1 KiB processed)[0m in 3.50s]
[0m02:45:17.385642 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.dim_event__data__object__items__data
[0m02:45:17.386293 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.dim_event__data__object__payment_method_types
[0m02:45:17.387006 [info ] [Thread-2 (]: 39 of 50 START sql incremental model stripe_tst_2_transformed.dim_event__data__object__payment_method_types  [RUN]
[0m02:45:17.387593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_event__data__object__items__data, now model.stripe_analytics_tst2.dim_event__data__object__payment_method_types)
[0m02:45:17.388149 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.dim_event__data__object__payment_method_types
[0m02:45:17.391551 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_event__data__object__payment_method_types"
[0m02:45:17.392280 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.dim_event__data__object__payment_method_types
[0m02:45:17.395707 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_event__data__object__payment_method_types"
[0m02:45:17.396420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:45:17.397864 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.dim_event__data__object__payment_method_types: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_event__data__object__payment_method_types"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__payment_method_types`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__payment_method_types */
/* Parent: event */

SELECT
    t.value,
    t._dlt_id,
    t._dlt_parent_id,
    t._dlt_list_idx,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__payment_method_types` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:17.757525 [info ] [Thread-4 (]: 36 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_event__data__object__discounts  [[32mCREATE TABLE (7.0 rows, 819.0 Bytes processed)[0m in 3.19s]
[0m02:45:17.758400 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.dim_event__data__object__discounts
[0m02:45:17.759036 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.dim_event__data__object__pending
[0m02:45:17.759755 [info ] [Thread-4 (]: 40 of 50 START sql incremental model stripe_tst_2_transformed.dim_event__data__object__pending  [RUN]
[0m02:45:17.760344 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_event__data__object__discounts, now model.stripe_analytics_tst2.dim_event__data__object__pending)
[0m02:45:17.760906 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.dim_event__data__object__pending
[0m02:45:17.764386 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_event__data__object__pending"
[0m02:45:17.765123 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.dim_event__data__object__pending
[0m02:45:17.768602 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_event__data__object__pending"
[0m02:45:17.769361 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:17.770857 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.dim_event__data__object__pending: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_event__data__object__pending"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__pending`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__pending */
/* Parent: event */

SELECT
    t.amount,
    t.currency,
    t.source_types__card,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__pending` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:17.797704 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:d2d49004-ca3f-4387-9960-09fe7c1a69f2&page=queryresults
[0m02:45:18.125972 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:bdeb924f-08c3-4aae-82f9-13cdd1d5e8df&page=queryresults
[0m02:45:18.261800 [info ] [Thread-1 (]: 37 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_event__data__object__lines__data  [[32mCREATE TABLE (12.0 rows, 6.7 KiB processed)[0m in 3.49s]
[0m02:45:18.262711 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.dim_event__data__object__lines__data
[0m02:45:18.263343 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts
[0m02:45:18.264060 [info ] [Thread-1 (]: 41 of 50 START sql incremental model stripe_tst_2_transformed.dim_event__data__object__total_discount_amounts  [RUN]
[0m02:45:18.264642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_event__data__object__lines__data, now model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts)
[0m02:45:18.265204 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts
[0m02:45:18.268680 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts"
[0m02:45:18.269407 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts
[0m02:45:18.274663 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts"
[0m02:45:18.275385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:18.276919 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__total_discount_amounts`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__total_discount_amounts */
/* Parent: event */

SELECT
    t.amount,
    t.discount,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__total_discount_amounts` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:18.522002 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:0ed38877-7430-4a55-9f6b-c1eb9fa96afb&page=queryresults
[0m02:45:19.053949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:cd9ea5f7-aa3a-471c-a572-b5a8f94c8d2d&page=queryresults
[0m02:45:20.320736 [info ] [Thread-3 (]: 38 of 50 OK created sql table model stripe_tst_2_transformed.stg_event__data__object__lines__data__discount_amounts  [[32mCREATE TABLE (6.0 rows, 654.0 Bytes processed)[0m in 3.34s]
[0m02:45:20.321696 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts
[0m02:45:20.322373 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.dim_invoice__discounts
[0m02:45:20.323160 [info ] [Thread-3 (]: 42 of 50 START sql incremental model stripe_tst_2_transformed.dim_invoice__discounts  [RUN]
[0m02:45:20.323780 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_event__data__object__lines__data__discount_amounts, now model.stripe_analytics_tst2.dim_invoice__discounts)
[0m02:45:20.324339 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.dim_invoice__discounts
[0m02:45:20.327841 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_invoice__discounts"
[0m02:45:20.328598 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.dim_invoice__discounts
[0m02:45:20.332058 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_invoice__discounts"
[0m02:45:20.332795 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:45:20.334272 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.dim_invoice__discounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_invoice__discounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_invoice__discounts`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice__discounts */
/* Parent: invoice */

SELECT
    t.value,
    t._dlt_id,
    t._dlt_parent_id,
    t._dlt_list_idx,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__discounts` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:20.896253 [info ] [Thread-2 (]: 39 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_event__data__object__payment_method_types  [[32mCREATE TABLE (8.0 rows, 712.0 Bytes processed)[0m in 3.51s]
[0m02:45:20.897161 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.dim_event__data__object__payment_method_types
[0m02:45:20.897798 [debug] [Thread-2 (]: Began running node model.stripe_analytics_tst2.dim_invoice__lines__data
[0m02:45:20.898543 [info ] [Thread-2 (]: 43 of 50 START sql incremental model stripe_tst_2_transformed.dim_invoice__lines__data  [RUN]
[0m02:45:20.899133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_event__data__object__payment_method_types, now model.stripe_analytics_tst2.dim_invoice__lines__data)
[0m02:45:20.899685 [debug] [Thread-2 (]: Began compiling node model.stripe_analytics_tst2.dim_invoice__lines__data
[0m02:45:20.903305 [debug] [Thread-2 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_invoice__lines__data"
[0m02:45:20.904045 [debug] [Thread-2 (]: Began executing node model.stripe_analytics_tst2.dim_invoice__lines__data
[0m02:45:20.907436 [debug] [Thread-2 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_invoice__lines__data"
[0m02:45:20.908143 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:45:20.909713 [debug] [Thread-2 (]: On model.stripe_analytics_tst2.dim_invoice__lines__data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_invoice__lines__data"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_invoice__lines__data`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice__lines__data */
/* Parent: invoice */

SELECT
    t.id,
    t.object,
    t.amount,
    t.amount_excluding_tax,
    t.currency,
    t.description,
    t.discountable,
    t.invoice,
    t.livemode,
    t.period__end,
    t.period__start,
    t.plan__id,
    t.plan__object,
    t.plan__active,
    t.plan__amount,
    t.plan__amount_decimal,
    t.plan__billing_scheme,
    t.plan__created,
    t.plan__currency,
    t.plan__interval,
    t.plan__interval_count,
    t.plan__livemode,
    t.plan__product,
    t.plan__usage_type,
    t.price__id,
    t.price__object,
    t.price__active,
    t.price__billing_scheme,
    t.price__created,
    t.price__currency,
    t.price__livemode,
    t.price__product,
    t.price__recurring__interval,
    t.price__recurring__interval_count,
    t.price__recurring__usage_type,
    t.price__tax_behavior,
    t.price__type,
    t.price__unit_amount,
    t.price__unit_amount_decimal,
    t.proration,
    t.quantity,
    t.subscription,
    t.subscription_item,
    t.type,
    t.unit_amount_excluding_tax,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__lines__data` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:21.296476 [info ] [Thread-4 (]: 40 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_event__data__object__pending  [[32mCREATE TABLE (1.0 rows, 397.0 Bytes processed)[0m in 3.54s]
[0m02:45:21.297311 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.dim_event__data__object__pending
[0m02:45:21.297925 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts
[0m02:45:21.298663 [info ] [Thread-4 (]: 44 of 50 START sql table model stripe_tst_2_transformed.stg_invoice__lines__data__discount_amounts  [RUN]
[0m02:45:21.299242 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_event__data__object__pending, now model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts)
[0m02:45:21.299792 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts
[0m02:45:21.303665 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts"
[0m02:45:21.304389 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts
[0m02:45:21.307177 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts"
[0m02:45:21.307908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:21.309359 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__lines__data__discount_amounts`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice__lines__data__discount_amounts */
/* Parent: { parent }} */


-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__lines__data`

SELECT
/* select which columns will be available for table 'invoice__lines__data__discount_amounts' */
    amount,
    discount,
    _dlt_parent_id,
    _dlt_list_idx,
    _dlt_id,
FROM `dlt-dev-external`.`stripe_tst_2`.`invoice__lines__data__discount_amounts`

/* we only load table items if the parent table has the parent item */
WHERE _dlt_parent_id IN ( SELECT _dlt_id FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__lines__data` )
    );
  
[0m02:45:22.173816 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:64b90868-027f-424f-9b5f-13eab487eeea&page=queryresults
[0m02:45:22.282522 [info ] [Thread-1 (]: 41 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_event__data__object__total_discount_amounts  [[32mCREATE TABLE (6.0 rows, 798.0 Bytes processed)[0m in 4.02s]
[0m02:45:22.284306 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts
[0m02:45:22.287676 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.dim_invoice__total_discount_amounts
[0m02:45:22.292826 [info ] [Thread-1 (]: 45 of 50 START sql incremental model stripe_tst_2_transformed.dim_invoice__total_discount_amounts  [RUN]
[0m02:45:22.293621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_event__data__object__total_discount_amounts, now model.stripe_analytics_tst2.dim_invoice__total_discount_amounts)
[0m02:45:22.294416 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.dim_invoice__total_discount_amounts
[0m02:45:22.299443 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_invoice__total_discount_amounts"
[0m02:45:22.300856 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.dim_invoice__total_discount_amounts
[0m02:45:22.316561 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_invoice__total_discount_amounts"
[0m02:45:22.318447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:22.324982 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.dim_invoice__total_discount_amounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_invoice__total_discount_amounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_invoice__total_discount_amounts`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice__total_discount_amounts */
/* Parent: invoice */

SELECT
    t.amount,
    t.discount,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__total_discount_amounts` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:23.129818 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:c0a2b036-8146-478f-8ef4-038b0c98beae&page=queryresults
[0m02:45:24.857593 [info ] [Thread-4 (]: 44 of 50 OK created sql table model stripe_tst_2_transformed.stg_invoice__lines__data__discount_amounts  [[32mCREATE TABLE (8.0 rows, 888.0 Bytes processed)[0m in 3.56s]
[0m02:45:24.858515 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts
[0m02:45:24.859143 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.dim_subscription__discounts
[0m02:45:24.859914 [info ] [Thread-4 (]: 46 of 50 START sql incremental model stripe_tst_2_transformed.dim_subscription__discounts  [RUN]
[0m02:45:24.860501 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.stg_invoice__lines__data__discount_amounts, now model.stripe_analytics_tst2.dim_subscription__discounts)
[0m02:45:24.861061 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.dim_subscription__discounts
[0m02:45:24.864494 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_subscription__discounts"
[0m02:45:24.865226 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.dim_subscription__discounts
[0m02:45:24.868706 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_subscription__discounts"
[0m02:45:24.869414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:24.870918 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.dim_subscription__discounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_subscription__discounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_subscription__discounts`
      
    
    

    OPTIONS()
    as (
      /* Table: subscription__discounts */
/* Parent: subscription */

SELECT
    t.value,
    t._dlt_id,
    t._dlt_parent_id,
    t._dlt_list_idx,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription__discounts` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:24.994117 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:e8912977-a252-45ba-a3be-868fd819ee48&page=queryresults
[0m02:45:25.654632 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:8b664f6e-3493-454d-92d1-ba1a839d2762&page=queryresults
[0m02:45:25.860559 [info ] [Thread-1 (]: 45 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_invoice__total_discount_amounts  [[32mCREATE TABLE (8.0 rows, 888.0 Bytes processed)[0m in 3.57s]
[0m02:45:25.861394 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.dim_invoice__total_discount_amounts
[0m02:45:25.862016 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.dim_subscription__items__data
[0m02:45:25.862765 [info ] [Thread-1 (]: 47 of 50 START sql incremental model stripe_tst_2_transformed.dim_subscription__items__data  [RUN]
[0m02:45:25.863362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_invoice__total_discount_amounts, now model.stripe_analytics_tst2.dim_subscription__items__data)
[0m02:45:25.863935 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.dim_subscription__items__data
[0m02:45:25.867335 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_subscription__items__data"
[0m02:45:25.868082 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.dim_subscription__items__data
[0m02:45:25.871604 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_subscription__items__data"
[0m02:45:25.872341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:25.873852 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.dim_subscription__items__data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_subscription__items__data"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_subscription__items__data`
      
    
    

    OPTIONS()
    as (
      /* Table: subscription__items__data */
/* Parent: subscription */

SELECT
    t.id,
    t.object,
    t.created,
    t.plan__id,
    t.plan__object,
    t.plan__active,
    t.plan__amount,
    t.plan__amount_decimal,
    t.plan__billing_scheme,
    t.plan__created,
    t.plan__currency,
    t.plan__interval,
    t.plan__interval_count,
    t.plan__livemode,
    t.plan__product,
    t.plan__usage_type,
    t.price__id,
    t.price__object,
    t.price__active,
    t.price__billing_scheme,
    t.price__created,
    t.price__currency,
    t.price__livemode,
    t.price__product,
    t.price__recurring__interval,
    t.price__recurring__interval_count,
    t.price__recurring__usage_type,
    t.price__tax_behavior,
    t.price__type,
    t.price__unit_amount,
    t.price__unit_amount_decimal,
    t.quantity,
    t.subscription,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription__items__data` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_subscription` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:26.685285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:4e1ec97d-fd01-42e1-9d04-223d8f894398&page=queryresults
[0m02:45:27.691135 [info ] [Thread-3 (]: 42 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_invoice__discounts  [[32mCREATE TABLE (8.0 rows, 824.0 Bytes processed)[0m in 7.37s]
[0m02:45:27.692035 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.dim_invoice__discounts
[0m02:45:27.692680 [debug] [Thread-3 (]: Began running node model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts
[0m02:45:27.693399 [info ] [Thread-3 (]: 48 of 50 START sql incremental model stripe_tst_2_transformed.dim_event__data__object__lines__data__discount_amounts  [RUN]
[0m02:45:27.693989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_invoice__discounts, now model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts)
[0m02:45:27.694580 [debug] [Thread-3 (]: Began compiling node model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts
[0m02:45:27.698106 [debug] [Thread-3 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts"
[0m02:45:27.699350 [debug] [Thread-3 (]: Began executing node model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts
[0m02:45:27.703012 [debug] [Thread-3 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts"
[0m02:45:27.705496 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:45:27.707029 [debug] [Thread-3 (]: On model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__lines__data__discount_amounts`
      
    
    

    OPTIONS()
    as (
      /* Table: event__data__object__lines__data__discount_amounts */
/* Parent: event__data__object__lines__data */

SELECT
    t.amount,
    t.discount,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__lines__data__discount_amounts` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_event__data__object__lines__data` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:28.104396 [info ] [Thread-4 (]: 46 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_subscription__discounts  [[32mCREATE TABLE (1.0 rows, 117.0 Bytes processed)[0m in 3.24s]
[0m02:45:28.105249 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.dim_subscription__discounts
[0m02:45:28.105916 [debug] [Thread-4 (]: Began running node model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts
[0m02:45:28.106692 [info ] [Thread-4 (]: 49 of 50 START sql incremental model stripe_tst_2_transformed.dim_invoice__lines__data__discount_amounts  [RUN]
[0m02:45:28.107289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_subscription__discounts, now model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts)
[0m02:45:28.107852 [debug] [Thread-4 (]: Began compiling node model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts
[0m02:45:28.111403 [debug] [Thread-4 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts"
[0m02:45:28.112119 [debug] [Thread-4 (]: Began executing node model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts
[0m02:45:28.115697 [debug] [Thread-4 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts"
[0m02:45:28.116422 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:45:28.117898 [debug] [Thread-4 (]: On model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_invoice__lines__data__discount_amounts`
      
    
    

    OPTIONS()
    as (
      /* Table: invoice__lines__data__discount_amounts */
/* Parent: invoice__lines__data */

SELECT
    t.amount,
    t.discount,
    t._dlt_parent_id,
    t._dlt_list_idx,
    t._dlt_id,
FROM  `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__lines__data__discount_amounts` as t
/* this join to the parent table is not necessarily needed for this template to work */
JOIN `dlt-dev-external`.`stripe_tst_2_transformed`.`stg_invoice__lines__data` as pt
ON (t._dlt_parent_id = pt._dlt_id)
    );
  
[0m02:45:28.436794 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:c679e6d4-f4cf-4459-8170-50dbee589cee&page=queryresults
[0m02:45:28.851483 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:39d57594-0113-4ea2-a48c-e4de61d3737d&page=queryresults
[0m02:45:29.130829 [info ] [Thread-1 (]: 47 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_subscription__items__data  [[32mCREATE TABLE (3.0 rows, 1.2 KiB processed)[0m in 3.27s]
[0m02:45:29.131719 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.dim_subscription__items__data
[0m02:45:30.088507 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:027b743d-c569-4ccf-bb8c-2f9adb4f9f3b&page=queryresults
[0m02:45:30.860217 [info ] [Thread-3 (]: 48 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_event__data__object__lines__data__discount_amounts  [[32mCREATE TABLE (6.0 rows, 654.0 Bytes processed)[0m in 3.17s]
[0m02:45:30.861135 [debug] [Thread-3 (]: Finished running node model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts
[0m02:45:31.314499 [info ] [Thread-4 (]: 49 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_invoice__lines__data__discount_amounts  [[32mCREATE TABLE (8.0 rows, 888.0 Bytes processed)[0m in 3.21s]
[0m02:45:31.315780 [debug] [Thread-4 (]: Finished running node model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts
[0m02:45:33.181999 [info ] [Thread-2 (]: 43 of 50 OK created sql incremental model stripe_tst_2_transformed.dim_invoice__lines__data  [[32mCREATE TABLE (17.0 rows, 9.4 KiB processed)[0m in 12.28s]
[0m02:45:33.182969 [debug] [Thread-2 (]: Finished running node model.stripe_analytics_tst2.dim_invoice__lines__data
[0m02:45:33.183945 [debug] [Thread-1 (]: Began running node model.stripe_analytics_tst2.dlt_processed_load_ids
[0m02:45:33.184759 [info ] [Thread-1 (]: 50 of 50 START sql incremental model stripe_tst_2_transformed.dlt_processed_load_ids  [RUN]
[0m02:45:33.185355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stripe_analytics_tst2.dim_subscription__items__data, now model.stripe_analytics_tst2.dlt_processed_load_ids)
[0m02:45:33.185930 [debug] [Thread-1 (]: Began compiling node model.stripe_analytics_tst2.dlt_processed_load_ids
[0m02:45:33.198665 [debug] [Thread-1 (]: Writing injected SQL for node "model.stripe_analytics_tst2.dlt_processed_load_ids"
[0m02:45:33.199388 [debug] [Thread-1 (]: Began executing node model.stripe_analytics_tst2.dlt_processed_load_ids
[0m02:45:33.202798 [debug] [Thread-1 (]: Writing runtime sql for node "model.stripe_analytics_tst2.dlt_processed_load_ids"
[0m02:45:33.203538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:33.205101 [debug] [Thread-1 (]: On model.stripe_analytics_tst2.dlt_processed_load_ids: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "bigquery", "target_name": "analytics", "node_id": "model.stripe_analytics_tst2.dlt_processed_load_ids"} */

  
    

    create or replace table `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_processed_load_ids`
      
    
    

    OPTIONS()
    as (
      
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim__dlt_loads`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`fact_subscription`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_coupon`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_customer`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_product`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_price`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`fact_event`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`fact_invoice`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`fact_balance_transaction`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_balance_transaction__fee_details`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__discounts`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__lines__data`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__lines__data__discount_amounts`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__total_discount_amounts`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__available`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__pending`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__payment_method_types`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_event__data__object__items__data`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_invoice__discounts`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_invoice__lines__data`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_invoice__lines__data__discount_amounts`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_invoice__total_discount_amounts`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_subscription__discounts`
-- depends_on: `dlt-dev-external`.`stripe_tst_2_transformed`.`dim_subscription__items__data`
/* we save all currently active load ids into the processed ids table */
select load_id, current_timestamp() as inserted_at FROM `dlt-dev-external`.`stripe_tst_2_transformed`.`dlt_active_load_ids`
    );
  
[0m02:45:33.982896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dlt-dev-external&j=bq:US:8532a19c-c9f3-4c1d-b329-9e35d27d39bf&page=queryresults
[0m02:45:36.529133 [info ] [Thread-1 (]: 50 of 50 OK created sql incremental model stripe_tst_2_transformed.dlt_processed_load_ids  [[32mCREATE TABLE (1.0 rows, 20.0 Bytes processed)[0m in 3.34s]
[0m02:45:36.530114 [debug] [Thread-1 (]: Finished running node model.stripe_analytics_tst2.dlt_processed_load_ids
[0m02:45:36.532020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:36.532520 [debug] [MainThread]: Connection 'model.stripe_analytics_tst2.dlt_processed_load_ids' was properly closed.
[0m02:45:36.533018 [debug] [MainThread]: Connection 'model.stripe_analytics_tst2.dim_event__data__object__lines__data__discount_amounts' was properly closed.
[0m02:45:36.533481 [debug] [MainThread]: Connection 'model.stripe_analytics_tst2.dim_invoice__lines__data__discount_amounts' was properly closed.
[0m02:45:36.533938 [debug] [MainThread]: Connection 'model.stripe_analytics_tst2.dim_invoice__lines__data' was properly closed.
[0m02:45:36.534625 [info ] [MainThread]: 
[0m02:45:36.535116 [info ] [MainThread]: Finished running 25 table models, 25 incremental models in 0 hours 0 minutes and 54.92 seconds (54.92s).
[0m02:45:36.542923 [debug] [MainThread]: Command end result
[0m02:45:36.604483 [info ] [MainThread]: 
[0m02:45:36.605128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:45:36.605836 [info ] [MainThread]: 
[0m02:45:36.606386 [info ] [MainThread]: Done. PASS=50 WARN=0 ERROR=0 SKIP=0 TOTAL=50
[0m02:45:36.607807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 56.014465, "process_user_time": 6.056429, "process_kernel_time": 0.403224, "process_mem_max_rss": "250860", "process_out_blocks": "5384", "process_in_blocks": "0"}
[0m02:45:36.608516 [debug] [MainThread]: Command `cli run` succeeded at 02:45:36.608402 after 56.02 seconds
[0m02:45:36.609050 [debug] [MainThread]: Flushing usage events


============================== 02:45:39.305989 | cf54912b-dd97-4b04-9d8f-5f549f8bd0d7 ==============================
[0m02:45:39.305989 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:45:39.308328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.python/current/lib/python3.12/site-packages/dlt/helpers/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/stripe-dlt-dbbt-model/dbt_stripe_analytics_tst2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m02:45:39.308895 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m02:45:39.955073 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m02:45:39.968301 [debug] [MainThread]: checksum: 4979aa4c9bb5bcfb384c4a4530246e9bb980b856d25b8329bb0b09ffc5919160, vars: {'destination_dataset_name': 'stripe_tst_2_transformed',
 'source_dataset_name': 'stripe_tst_2'}, profile: bigquery, target: , version: 1.8.7
[0m02:45:40.130860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:45:40.131750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:45:40.394989 [info ] [MainThread]: Found 50 models, 25 sources, 479 macros
[0m02:45:40.397927 [info ] [MainThread]: 
[0m02:45:40.398448 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:45:40.400341 [debug] [MainThread]: Command end result
[0m02:45:40.450352 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2096729, "process_user_time": 3.12222, "process_kernel_time": 0.347356, "process_mem_max_rss": "242472", "process_in_blocks": "1968", "process_out_blocks": "3904"}
[0m02:45:40.451088 [debug] [MainThread]: Command `cli test` succeeded at 02:45:40.450973 after 1.21 seconds
[0m02:45:40.451601 [debug] [MainThread]: Flushing usage events
