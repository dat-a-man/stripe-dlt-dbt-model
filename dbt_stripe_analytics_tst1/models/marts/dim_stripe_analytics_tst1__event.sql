/* Table: event */
{{
    config(
        materialized='incremental'
    )
}}
SELECT
    t."id",
    t."object",
    t."api_version",
    t."created",
    t."data__object__object",
    t."data__object__livemode",
    t."livemode",
    t."pending_webhooks",
    t."type",
    t."_dlt_load_id",
    t."_dlt_id",
    t."data__object__id",
    t."data__object__account_country",
    t."data__object__amount_due",
    t."data__object__amount_paid",
    t."data__object__amount_remaining",
    t."data__object__amount_shipping",
    t."data__object__attempt_count",
    t."data__object__attempted",
    t."data__object__auto_advance",
    t."data__object__automatic_tax__enabled",
    t."data__object__billing_reason",
    t."data__object__charge",
    t."data__object__collection_method",
    t."data__object__created",
    t."data__object__currency",
    t."data__object__customer",
    t."data__object__customer_email",
    t."data__object__customer_name",
    t."data__object__customer_tax_exempt",
    t."data__object__discount__id",
    t."data__object__discount__object",
    t."data__object__discount__coupon__id",
    t."data__object__discount__coupon__object",
    t."data__object__discount__coupon__created",
    t."data__object__discount__coupon__duration",
    t."data__object__discount__coupon__livemode",
    t."data__object__discount__coupon__percent_off",
    t."data__object__discount__coupon__times_redeemed",
    t."data__object__discount__coupon__valid",
    t."data__object__discount__customer",
    t."data__object__discount__start",
    t."data__object__discount__subscription",
    t."data__object__effective_at",
    t."data__object__ending_balance",
    t."data__object__hosted_invoice_url",
    t."data__object__invoice_pdf",
    t."data__object__issuer__type",
    t."data__object__lines__object",
    t."data__object__lines__has_more",
    t."data__object__lines__total_count",
    t."data__object__lines__url",
    t."data__object__number",
    t."data__object__paid",
    t."data__object__paid_out_of_band",
    t."data__object__payment_intent",
    t."data__object__period_end",
    t."data__object__period_start",
    t."data__object__post_payment_credit_notes_amount",
    t."data__object__pre_payment_credit_notes_amount",
    t."data__object__starting_balance",
    t."data__object__status",
    t."data__object__status_transitions__finalized_at",
    t."data__object__status_transitions__paid_at",
    t."data__object__subscription",
    t."data__object__subtotal",
    t."data__object__subtotal_excluding_tax",
    t."data__object__total",
    t."data__object__total_excluding_tax",
    t."data__object__webhooks_delivered_at",
    t."data__previous_attributes__amount_paid",
    t."data__previous_attributes__amount_remaining",
    t."data__previous_attributes__attempt_count",
    t."data__previous_attributes__attempted",
    t."data__previous_attributes__auto_advance",
    t."data__previous_attributes__automatically_finalizes_at",
    t."data__previous_attributes__next_payment_attempt",
    t."data__previous_attributes__paid",
    t."data__previous_attributes__status",
    t."data__object__amount",
    t."data__object__amount_capturable",
    t."data__object__amount_received",
    t."data__object__capture_method",
    t."data__object__client_secret",
    t."data__object__confirmation_method",
    t."data__object__description",
    t."data__object__invoice",
    t."data__object__payment_method_options__card__request_three_d_secure",
    t."data__object__latest_charge",
    t."data__object__payment_method",
    t."request__idempotency_key",
    t."data__object__amount_captured",
    t."data__object__amount_refunded",
    t."data__object__balance_transaction",
    t."data__object__calculated_statement_descriptor",
    t."data__object__captured",
    t."data__object__disputed",
    t."data__object__outcome__network_status",
    t."data__object__outcome__risk_level",
    t."data__object__outcome__risk_score",
    t."data__object__outcome__seller_message",
    t."data__object__outcome__type",
    t."data__object__payment_method_details__card__amount_authorized",
    t."data__object__payment_method_details__card__brand",
    t."data__object__payment_method_details__card__country",
    t."data__object__payment_method_details__card__exp_month",
    t."data__object__payment_method_details__card__exp_year",
    t."data__object__payment_method_details__card__extended_authorization__status",
    t."data__object__payment_method_details__card__fingerprint",
    t."data__object__payment_method_details__card__funding",
    t."data__object__payment_method_details__card__incremental_authorization__status",
    t."data__object__payment_method_details__card__last4",
    t."data__object__payment_method_details__card__multicapture__status",
    t."data__object__payment_method_details__card__network",
    t."data__object__payment_method_details__card__network_token__used",
    t."data__object__payment_method_details__card__overcapture__maximum_amount_capturable",
    t."data__object__payment_method_details__card__overcapture__status",
    t."data__object__payment_method_details__type",
    t."data__object__receipt_url",
    t."data__object__refunded",
    t."data__object__billing_cycle_anchor",
    t."data__object__cancel_at_period_end",
    t."data__object__current_period_end",
    t."data__object__current_period_start",
    t."data__object__invoice_settings__issuer__type",
    t."data__object__items__object",
    t."data__object__items__has_more",
    t."data__object__items__total_count",
    t."data__object__items__url",
    t."data__object__latest_invoice",
    t."data__object__payment_settings__save_default_payment_method",
    t."data__object__plan__id",
    t."data__object__plan__object",
    t."data__object__plan__active",
    t."data__object__plan__amount",
    t."data__object__plan__amount_decimal",
    t."data__object__plan__billing_scheme",
    t."data__object__plan__created",
    t."data__object__plan__currency",
    t."data__object__plan__interval",
    t."data__object__plan__interval_count",
    t."data__object__plan__livemode",
    t."data__object__plan__product",
    t."data__object__plan__usage_type",
    t."data__object__quantity",
    t."data__object__start_date",
    t."data__object__trial_settings__end_behavior__missing_payment_method",
    t."data__previous_attributes__current_period_end",
    t."data__previous_attributes__current_period_start",
    t."data__previous_attributes__latest_invoice",
    t."data__object__automatically_finalizes_at",
    t."data__object__next_payment_attempt",
FROM  {{ ref('stg_stripe_analytics_tst1__event') }} as t