/* Table: invoice */
{{
    config(
        materialized='incremental'
    )
}}
SELECT
    t."id",
    t."object",
    t."account_country",
    t."amount_due",
    t."amount_paid",
    t."amount_remaining",
    t."amount_shipping",
    t."attempt_count",
    t."attempted",
    t."auto_advance",
    t."automatic_tax__enabled",
    t."billing_reason",
    t."charge",
    t."collection_method",
    t."created",
    t."currency",
    t."customer",
    t."customer_email",
    t."customer_name",
    t."customer_tax_exempt",
    t."discount__id",
    t."discount__object",
    t."discount__coupon__id",
    t."discount__coupon__object",
    t."discount__coupon__created",
    t."discount__coupon__duration",
    t."discount__coupon__livemode",
    t."discount__coupon__percent_off",
    t."discount__coupon__times_redeemed",
    t."discount__coupon__valid",
    t."discount__customer",
    t."discount__start",
    t."discount__subscription",
    t."effective_at",
    t."ending_balance",
    t."hosted_invoice_url",
    t."invoice_pdf",
    t."issuer__type",
    t."lines__object",
    t."lines__has_more",
    t."lines__total_count",
    t."lines__url",
    t."livemode",
    t."number",
    t."paid",
    t."paid_out_of_band",
    t."payment_intent",
    t."period_end",
    t."period_start",
    t."post_payment_credit_notes_amount",
    t."pre_payment_credit_notes_amount",
    t."starting_balance",
    t."status",
    t."status_transitions__finalized_at",
    t."status_transitions__paid_at",
    t."subscription",
    t."subtotal",
    t."subtotal_excluding_tax",
    t."total",
    t."total_excluding_tax",
    t."webhooks_delivered_at",
    t."_dlt_load_id",
    t."_dlt_id",
FROM  {{ ref('stg_stripe_analytics_tst1__invoice') }} as t