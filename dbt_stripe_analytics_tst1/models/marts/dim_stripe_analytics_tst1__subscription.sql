/* Table: subscription */
{{
    config(
        materialized='incremental'
    )
}}
SELECT
    t."id",
    t."object",
    t."automatic_tax__enabled",
    t."billing_cycle_anchor",
    t."cancel_at_period_end",
    t."collection_method",
    t."created",
    t."currency",
    t."current_period_end",
    t."current_period_start",
    t."customer",
    t."discount__id",
    t."discount__object",
    t."discount__coupon__id",
    t."discount__coupon__object",
    t."discount__coupon__created",
    t."discount__coupon__duration",
    t."discount__coupon__livemode",
    t."discount__coupon__percent_off",
    t."discount__coupon__times_redeemed",
    t."discount__coupon__valid",
    t."discount__customer",
    t."discount__start",
    t."discount__subscription",
    t."invoice_settings__issuer__type",
    t."items__object",
    t."items__has_more",
    t."items__total_count",
    t."items__url",
    t."latest_invoice",
    t."livemode",
    t."payment_settings__save_default_payment_method",
    t."plan__id",
    t."plan__object",
    t."plan__active",
    t."plan__amount",
    t."plan__amount_decimal",
    t."plan__billing_scheme",
    t."plan__created",
    t."plan__currency",
    t."plan__interval",
    t."plan__interval_count",
    t."plan__livemode",
    t."plan__product",
    t."plan__usage_type",
    t."quantity",
    t."start_date",
    t."status",
    t."trial_settings__end_behavior__missing_payment_method",
    t."_dlt_load_id",
    t."_dlt_id",
FROM  {{ ref('stg_stripe_analytics_tst1__subscription') }} as t